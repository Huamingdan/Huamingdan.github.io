<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.8.0">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="1. 课程大纲在线地址：JavaScript 高级


2. 回顾创建对象的四种方式：字面量、Object、工厂、构造函数
2.1 构造函数创建对象12345678910111213141516171819202122232425//自定义构造函数-----&amp;gt;实例化对象function Per">
    

    <!--Author-->
    
        <meta name="author" content="Huamingdan">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="king of the web">
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="king of the web">

    <!--Type page-->
    
        <meta property="og:type" content="website">
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary">
    

    <!-- Title -->
    
    <title>king of the web</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    


</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about.html">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact.html">
                    Contact
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/2019/05/06/03-JavaScript高级/">
                Untitled
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2019-05-06</span>
            
            
            
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <h2 id="1-课程大纲"><a href="#1-课程大纲" class="headerlink" title="1. 课程大纲"></a>1. 课程大纲</h2><p>在线地址：<a href="http://naotu.baidu.com/file/5bcd79bc4f1eaf83f96d1ad23baab345?token=d22135c63546f5ee" target="_blank" rel="noopener">JavaScript 高级</a></p>
<p><img src="./media/课程大纲.png" alt="课程大纲"></p>
<hr>
<h2 id="2-回顾"><a href="#2-回顾" class="headerlink" title="2. 回顾"></a>2. 回顾</h2><p>创建对象的四种方式：字面量、Object、工厂、构造函数</p>
<h3 id="2-1-构造函数创建对象"><a href="#2-1-构造函数创建对象" class="headerlink" title="2.1 构造函数创建对象"></a>2.1 构造函数创建对象</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//自定义构造函数-----&gt;实例化对象</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age,sex</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name=name;</span><br><span class="line">    <span class="keyword">this</span>.age=age;</span><br><span class="line">    <span class="keyword">this</span>.sex=sex;</span><br><span class="line">    <span class="keyword">this</span>.eat=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"吃大蒜拌臭豆腐加榴莲酱"</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//构造函数----&gt;创建对象</span></span><br><span class="line"><span class="keyword">var</span> per=<span class="keyword">new</span> Person(<span class="string">"小苏"</span>,<span class="number">38</span>,<span class="string">"女"</span>);</span><br><span class="line"><span class="comment">//per.eat();//吃</span></span><br><span class="line"><span class="comment">//实例对象是通过构造函数来创建</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//把这个对象的结构显示出来</span></span><br><span class="line"><span class="built_in">console</span>.dir(per);</span><br><span class="line"><span class="built_in">console</span>.dir(Person);</span><br><span class="line"></span><br><span class="line"><span class="comment">//实例对象的构造器(构造函数)</span></span><br><span class="line"><span class="comment">//实例对象的构造器是指向Person的,结果是true,所以,这个实例对象per就是通过Person来创建的</span></span><br><span class="line"><span class="built_in">console</span>.log(per.constructor==Person);<span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//判断这个对象是不是这种数据类型</span></span><br><span class="line"><span class="built_in">console</span>.log(dog.constructor==Animal);</span><br><span class="line"><span class="built_in">console</span>.log(dog <span class="keyword">instanceof</span> Person);</span><br></pre></td></tr></table></figure>
<h3 id="2-2-构造函数创建对象带来的问题"><a href="#2-2-构造函数创建对象带来的问题" class="headerlink" title="2.2 构造函数创建对象带来的问题"></a>2.2 构造函数创建对象带来的问题</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name=name;</span><br><span class="line">    <span class="keyword">this</span>.age=age;</span><br><span class="line">    <span class="keyword">this</span>.eat=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"今天吃红烧土豆"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> per1=<span class="keyword">new</span> Person(<span class="string">"小白"</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">var</span> per2=<span class="keyword">new</span> Person(<span class="string">"小黑"</span>,<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.dir(per1.eat == per2.eat);</span><br><span class="line"><span class="comment">//上面的打印结果为false，每个对象的信息不共享</span></span><br></pre></td></tr></table></figure>
<h2 id="3-原型介绍"><a href="#3-原型介绍" class="headerlink" title="3. 原型介绍"></a>3. 原型介绍</h2><p>​    什么是原型：原型是Javascript中的继承的基础，我们可以把一个函数的所有对象公共的属性和方法放入到函数的原型中。</p>
<h3 id="3-1-通过原型共享属性和方法"><a href="#3-1-通过原型共享属性和方法" class="headerlink" title="3.1 通过原型共享属性和方法"></a>3.1 通过原型共享属性和方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name=name;</span><br><span class="line">    <span class="keyword">this</span>.age=age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//通过原型来添加方法,解决数据共享,节省内存空间</span></span><br><span class="line">Person.prototype.eat=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"吃凉菜"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1=<span class="keyword">new</span> Person(<span class="string">"小明"</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">var</span> p2=<span class="keyword">new</span> Person(<span class="string">"小红"</span>,<span class="number">30</span>);</span><br><span class="line"><span class="built_in">console</span>.log(p1.eat==p2.eat);<span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.dir(p1);</span><br><span class="line"><span class="built_in">console</span>.dir(p2);</span><br><span class="line"></span><br><span class="line"><span class="comment">//什么样子的数据是需要写在原型中?</span></span><br><span class="line"><span class="number">1.</span>需要共享的数据就可以写原型中，比如需要共享的属性和方法</span><br><span class="line"><span class="number">2.</span>不需要共享的数据写在构造函数中</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//原型的作用一:数据共享</span></span><br><span class="line"><span class="comment">//构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name,age,sex</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name=name;</span><br><span class="line">  <span class="keyword">this</span>.age=age;</span><br><span class="line">  <span class="keyword">this</span>.sex=sex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//所有学生的身高都是188,所有人的体重都是55</span></span><br><span class="line"><span class="comment">//所有学生都要每天写500行代码</span></span><br><span class="line"><span class="comment">//所有学生每天都要吃一个10斤的西瓜</span></span><br><span class="line"><span class="comment">//原型对象</span></span><br><span class="line">Student.prototype.height=<span class="string">"188"</span>;</span><br><span class="line">Student.prototype.weight=<span class="string">"55kg"</span>;</span><br><span class="line">Student.prototype.study=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"学习,写500行代码,小菜一碟"</span>);</span><br><span class="line">&#125;;</span><br><span class="line">Student.prototype.eat=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"吃一个10斤的西瓜"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//实例化对象,并初始化</span></span><br><span class="line"><span class="keyword">var</span> stu=<span class="keyword">new</span> Student(<span class="string">"晨光"</span>,<span class="number">57</span>,<span class="string">"女"</span>);</span><br><span class="line"><span class="built_in">console</span>.dir(Student);<span class="comment">//可以看到Student函数中有一个prototype，prototype中存放了我们所定义的若干方法</span></span><br><span class="line"><span class="built_in">console</span>.dir(stu);<span class="comment">//可以看到stu的__proto__实际就是Student.prototype</span></span><br></pre></td></tr></table></figure>
<h3 id="3-2-原型-prototype和-proto"><a href="#3-2-原型-prototype和-proto" class="headerlink" title="3.2 原型: prototype和 proto "></a>3.2 原型: prototype和<strong> proto </strong></h3><p>​    实例对象中有<strong> proto </strong>这个属性,指向函数的原型,是一个对象,这个属性是给浏览器使用,不是标准的属性<br>    构造函数中有prototype这个属性,叫函数的原型,是一个对象,这个属性是给程序员使用,是标准的属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>) </span>&#123;</span><br><span class="line">     <span class="keyword">this</span>.name=name;</span><br><span class="line">     <span class="keyword">this</span>.age=age;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">//通过原型来添加方法,解决数据共享,节省内存空间</span></span><br><span class="line">   Person.prototype.eat=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">"吃凉菜"</span>);</span><br><span class="line">   &#125;;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> p1=<span class="keyword">new</span> Person(<span class="string">"小明"</span>,<span class="number">20</span>);</span><br><span class="line">   <span class="keyword">var</span> p2=<span class="keyword">new</span> Person(<span class="string">"小红"</span>,<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line">   <span class="built_in">console</span>.dir(p1);</span><br><span class="line">   <span class="built_in">console</span>.dir(p2);</span><br><span class="line">   <span class="built_in">console</span>.dir(Person);</span><br><span class="line"></span><br><span class="line">   <span class="built_in">console</span>.log(p1.__proto__==Person.prototype); <span class="comment">//true</span></span><br><span class="line">   p1.__proto__.eat();</span><br></pre></td></tr></table></figure>
<h3 id="3-3-构造函数、实例、原型三者之间的关系"><a href="#3-3-构造函数、实例、原型三者之间的关系" class="headerlink" title="3.3 构造函数、实例、原型三者之间的关系"></a>3.3 构造函数、实例、原型三者之间的关系</h3><p><img src="media/aa.jpg" alt></p>
<p><img src="media/aa.png" alt></p>
<p>​    1. 任何函数都具有一个    <code>prototype</code> 属性，该属性是一个对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="built_in">console</span>.log(F.prototype) <span class="comment">// =&gt; object</span></span><br><span class="line"></span><br><span class="line">F.prototype.sayHi = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'hi!'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​    2. 构造函数的 <code>prototype 对象默认都有一个</code>constructor<code>属性，指向</code>prototype对象所在函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(F.prototype.constructor === F) <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure>
<p>​    3. 通过构造函数得到的实例对象内部会包含一个指向构造函数的 <code>prototype</code> 对象的指针 <code>__proto__</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> instance = <span class="keyword">new</span> F()</span><br><span class="line"><span class="built_in">console</span>.log(instance.__proto__ === F.prototype) <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="built_in">console</span>.log(instance.__proto__.constructor==F);</span><br><span class="line"><span class="built_in">console</span>.log(instance.__proto__.constructor === F.prototype.constructor) <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure>
<p>​    <img src="media/yuanxin.png" alt></p>
<p>​    4.总结</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1) 任何函数都具有一个 prototype 属性，该属性是一个对象</span><br><span class="line">2) 构造函数的 prototype 对象默认都有一个 constructor 属性，指向 prototype 对象所在函数</span><br><span class="line">3) 通过构造函数得到的实例对象内部会包含一个指向构造函数的 prototype 对象的指针 __proto__</span><br><span class="line">4) 所有实例都直接或间接继承了原型对象的成员</span><br><span class="line">5) 构造函数的原型对象(prototype)中的属性和方法是可以被实例对象直接访问的</span><br></pre></td></tr></table></figure>
<h3 id="3-4-修改原型"><a href="#3-4-修改原型" class="headerlink" title="3.4 修改原型"></a>3.4 修改原型</h3><p>​    我们注意到，前面例子中每添加一个属性和方法就要敲一遍     <code>Person.prototype</code> 。<br>    为减少不必要的输入，更常见的做法是用一个包含所有属性和方法的对象字面量来重写整个原型对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name</span><br><span class="line">  <span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.sayHi = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Person~~~hi!'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*这样修改完之后，Person的原型中只有type和sayHello信息，把之前的sayHi以及constructor给丢失了*/</span></span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">  type: <span class="string">'human'</span>,</span><br><span class="line">  sayHello: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'我叫'</span> + <span class="keyword">this</span>.name + <span class="string">'，我今年'</span> + <span class="keyword">this</span>.age + <span class="string">'岁了'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​    在该示例中，我们将   <code>Person.prototype</code> 重置到了一个新的对象。<br>    这样做的好处就是为   <code>Person.prototype</code> 添加成员简单了，但是也会带来一个问题，那就是原型对象丢失了 <code>constructor</code> 成员(其实我们不写的时候会把constructor设置为Object的构造器)。</p>
<p>​    所以，我们为了保持   <code>constructor</code> 的指向正确，建议的写法是：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name</span><br><span class="line">  <span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.sayHi = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Person~~~hi!'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">  <span class="keyword">constructor</span>: Person, // =&gt; 手动将 <span class="keyword">constructor</span> 指向正确的构造函数</span><br><span class="line">  type: 'human',</span><br><span class="line">  sayHello: function () &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'我叫'</span> + <span class="keyword">this</span>.name + <span class="string">'，我今年'</span> + <span class="keyword">this</span>.age + <span class="string">'岁了'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  sayHi: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  	<span class="built_in">console</span>.log(<span class="string">'Person~~~hi!'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-5-原型方法的互相访问"><a href="#3-5-原型方法的互相访问" class="headerlink" title="3.5 原型方法的互相访问"></a>3.5 原型方法的互相访问</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//原型对象中的方法,可以相互调用</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params">name,age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name=name;</span><br><span class="line">    <span class="keyword">this</span>.age=age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//原型中添加方法</span></span><br><span class="line">Animal.prototype.eat=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"动物吃东西"</span>);</span><br><span class="line">    <span class="keyword">this</span>.play();</span><br><span class="line">&#125;;</span><br><span class="line">Animal.prototype.play=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"玩球"</span>);</span><br><span class="line">    <span class="keyword">this</span>.sleep();</span><br><span class="line">&#125;;</span><br><span class="line">Animal.prototype.sleep=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"睡觉了"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dog = <span class="keyword">new</span> Animal(<span class="string">"小苏"</span>,<span class="number">20</span>);</span><br><span class="line">dog.eat();</span><br></pre></td></tr></table></figure>
<h3 id="3-6-原生对象的原型"><a href="#3-6-原生对象的原型" class="headerlink" title="3.6 原生对象的原型"></a>3.6 原生对象的原型</h3><p>​    所有函数都有 prototype 属性对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. Object.prototype</span><br><span class="line">2. Function.prototype</span><br><span class="line">3. Array.prototype</span><br><span class="line">4. String.prototype</span><br><span class="line">5. Number.prototype</span><br><span class="line">6. Date.prototype</span><br><span class="line">7. ...</span><br></pre></td></tr></table></figure>
<p>​    练习：为数组对象和字符串对象扩展原型方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//我们能否为系统的对象的原型中添加方法,相当于在改变源码</span></span><br><span class="line"><span class="comment">//我希望字符串中有一个倒序字符串的方法</span></span><br><span class="line"><span class="built_in">String</span>.prototype.myReverse = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="keyword">this</span>.length<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"abcdefg"</span>;</span><br><span class="line">str.myReverse();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">String</span>.prototype.sayHi=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>+<span class="string">"哈哈,我又变帅了"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//字符串就有了打招呼的方法</span></span><br><span class="line"><span class="keyword">var</span> str2=<span class="string">"小杨"</span>;</span><br><span class="line">str2.sayHi();</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//为Array内置对象的原型对象中添加方法</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.mySort=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="keyword">this</span>.length<span class="number">-1</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>;j&lt;<span class="keyword">this</span>.length<span class="number">-1</span>-i;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>[j]&lt;<span class="keyword">this</span>[j+<span class="number">1</span>])&#123;</span><br><span class="line">                <span class="keyword">var</span> temp=<span class="keyword">this</span>[j];</span><br><span class="line">                <span class="keyword">this</span>[j]=<span class="keyword">this</span>[j+<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">this</span>[j+<span class="number">1</span>]=temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr=[<span class="number">100</span>,<span class="number">3</span>,<span class="number">56</span>,<span class="number">78</span>,<span class="number">23</span>,<span class="number">10</span>];</span><br><span class="line">arr.mySort();</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br></pre></td></tr></table></figure>
<h2 id="4-函数自调用"><a href="#4-函数自调用" class="headerlink" title="4. 函数自调用"></a>4. 函数自调用</h2><h3 id="4-1-自调用函数的概念"><a href="#4-1-自调用函数的概念" class="headerlink" title="4.1 自调用函数的概念"></a>4.1 自调用函数的概念</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//自调用函数是一次性的函数--声明的同时,直接调用了</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> num=<span class="number">10</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"函数"</span>);</span><br><span class="line">&#125;());</span><br><span class="line"><span class="built_in">console</span>.log(num);</span><br></pre></td></tr></table></figure>
<h3 id="4-2-自调用函数作用"><a href="#4-2-自调用函数作用" class="headerlink" title="4.2 自调用函数作用"></a>4.2 自调用函数作用</h3><p>​    自调用函数作用：开启一个新的作用域，可以防止变量命名污染的问题</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//自调用函数的好处：我们自己写的代码不会对外部的js代码有任何影响</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//我们在开发的时候会引入很多第三方的js文件，有时候我们并不直到在第三方js中谢了什么函数</span></span><br><span class="line"><span class="comment">//假如第三方js已经写好了一个函数如下：</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"aa"</span>);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//而我们不知情，又写了下面代码</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"bb"</span>);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//这个时候我们自己写的代码就会把第三方的js代码给顶掉</span></span><br><span class="line"><span class="comment">//而如果使用自调用函数则没有这个情况</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"这是我自己的foo"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    foo();</span><br><span class="line">&#125;());</span><br><span class="line">foo();</span><br><span class="line"><span class="comment">//推荐在以后的开发工多使用自调用函数,把所有的js代码都放在自调用函数中</span></span><br></pre></td></tr></table></figure>
<h3 id="4-3-自调用函数-沙箱"><a href="#4-3-自调用函数-沙箱" class="headerlink" title="4.3 自调用函数-沙箱"></a>4.3 自调用函数-沙箱</h3><p>​    示例：沙箱模式 ： 独立的环境，不会影响外面的世界</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//沙箱:环境,黑盒,在一个虚拟的环境中模拟真实世界做实验,实验结果和真实世界的结果是一样,但是不会影响真实世界</span></span><br><span class="line"><span class="comment">//自调用函数中变量是私有的，但是自调用函数是可以访问外部资源</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> num=<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//沙箱---小环境</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> num=<span class="number">10</span>;</span><br><span class="line">      <span class="built_in">console</span>.log(num);</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"> <span class="comment">//沙箱---小环境</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(num); <span class="comment">//沙箱中是可以访问外部资源的</span></span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="comment">//以后建议代码都放到沙箱里面</span></span><br></pre></td></tr></table></figure>
<h3 id="4-4-自调用函数-沙箱案例"><a href="#4-4-自调用函数-沙箱案例" class="headerlink" title="4.4 自调用函数-沙箱案例"></a>4.4 自调用函数-沙箱案例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;这是div&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;div&gt;这是div&lt;/</span>div&gt;</span><br><span class="line">&lt;div&gt;这是div&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;p&gt;这是p&lt;/</span>p&gt;</span><br><span class="line">&lt;p&gt;这是p&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;p&gt;这是p&lt;/</span>p&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">var</span> getTag = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">var</span> dvObjs = <span class="number">20</span>;</span><br><span class="line">  <span class="keyword">var</span> pObjs = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//此处如果不加沙箱，在调用getTag方法的时候会报not function错误，原因是getTag()这个函数会被提升到script代码块的最前面</span></span><br><span class="line">  (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//根据标签名字获取元素</span></span><br><span class="line">    <span class="comment">//自调用函数中的函数是私有的，在外部不可以被访问</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getTag</span>(<span class="params">tagName</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">document</span>.getElementsByTagName(tagName)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获取所有的div</span></span><br><span class="line">    <span class="keyword">var</span> dvObjs = getTag(<span class="string">"div"</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; dvObjs.length; i++) &#123;</span><br><span class="line">      dvObjs[i].style.border = <span class="string">"2px solid pink"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获取所有的p</span></span><br><span class="line">    <span class="keyword">var</span> pObjs = getTag(<span class="string">"p"</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; pObjs.length; i++) &#123;</span><br><span class="line">      pObjs[i].style.border = <span class="string">"2px solid pink"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;());</span><br><span class="line">  <span class="built_in">console</span>.log(getTag);</span><br><span class="line">  <span class="built_in">console</span>.log(dvObjs);</span><br><span class="line">  <span class="built_in">console</span>.log(pObjs);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="4-5-自调用函数注意点"><a href="#4-5-自调用函数注意点" class="headerlink" title="4.5 自调用函数注意点"></a>4.5 自调用函数注意点</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 问题1：如果存在多个自调用函数要用分号分割，否则语法错误</span></span><br><span class="line"><span class="comment">// 下面代码会报错</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;())</span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 问题2：当自调用函数 前面有匿名函数时，会把自调用函数作为参数(其实会匿名函数和自调用函数中的空格去掉)</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  alert(<span class="string">'11'</span>);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  alert(<span class="string">'22'</span>);</span><br><span class="line">&#125;())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 代码规范中会建议在自调用函数之前加上分号</span></span><br><span class="line">;(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;())</span><br><span class="line"></span><br><span class="line">;(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;())</span><br></pre></td></tr></table></figure>
<h3 id="4-6-自调用函数中的全局变量"><a href="#4-6-自调用函数中的全局变量" class="headerlink" title="4.6 自调用函数中的全局变量"></a>4.6 自调用函数中的全局变量</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">//沙箱---小环境</span></span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> num=<span class="number">10</span>;  </span><br><span class="line">    &#125;)();</span><br><span class="line">    <span class="built_in">console</span>.log(num); <span class="comment">//无法访问</span></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/虽然在自调用函数中的变量是局部变量，但是我们仍然可以通过window将自调用函数中的局部变量变为全局变量</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">//沙箱---小环境</span></span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">         num=<span class="number">10</span>;  <span class="comment">//这个地方相当于window.num = 10;</span></span><br><span class="line">    &#125;)();</span><br><span class="line">    <span class="built_in">console</span>.log(num);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/虽然在自调用函数中的变量是局部变量，但是我们仍然可以通过window将自调用函数中的局部变量变为全局变量</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将局部变量变成全局变量更常见的做法如下:</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">window</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> num=<span class="number">10</span>;<span class="comment">//局部变量</span></span><br><span class="line">    <span class="built_in">window</span>.num=num;<span class="comment">//全局变量</span></span><br><span class="line">&#125;)(<span class="built_in">window</span>);</span><br><span class="line"><span class="built_in">console</span>.log(num);</span><br></pre></td></tr></table></figure>
<h3 id="4-7-自调用函数封装Random对象"><a href="#4-7-自调用函数封装Random对象" class="headerlink" title="4.7 自调用函数封装Random对象"></a>4.7 自调用函数封装Random对象</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过自调用函数产生一个随机数对象,在自调用函数外面,调用该随机数对象方法产生随机数</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">window</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//产生随机数的构造函数</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Random</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//在原型对象中添加方法</span></span><br><span class="line">  Random.prototype.getRandom = <span class="function"><span class="keyword">function</span> (<span class="params">min,max</span>) </span>&#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*(max-min)+min);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">//自调用函数中的普通函数是私有函数，只能够在当前自调用函数内部使用</span></span><br><span class="line">  <span class="comment">//要想把这个方法暴露给外部，可以设置给window，或者设置给Random函数</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">"test1"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//把Random对象暴露给顶级对象window---&gt;外部可以直接使用这个对象</span></span><br><span class="line">  <span class="built_in">window</span>.Random=Random;</span><br><span class="line">&#125;)(<span class="built_in">window</span>);</span><br><span class="line"><span class="comment">//实例化随机数对象,这边能够使用Random函数，原因是Random函数已经被绑定到了window对象上</span></span><br><span class="line"><span class="keyword">var</span> rm=<span class="keyword">new</span> Random();</span><br><span class="line"><span class="comment">//调用方法产生随机数</span></span><br><span class="line"><span class="built_in">console</span>.log(rm.getRandom(<span class="number">0</span>,<span class="number">5</span>));</span><br><span class="line">test1();  <span class="comment">//无法访问，test1()是私有函数</span></span><br></pre></td></tr></table></figure>
<h2 id="5-面向对象游戏案例：贪吃蛇"><a href="#5-面向对象游戏案例：贪吃蛇" class="headerlink" title="5. 面向对象游戏案例：贪吃蛇"></a>5. 面向对象游戏案例：贪吃蛇</h2><h3 id="5-1-搭建页面"><a href="#5-1-搭建页面" class="headerlink" title="5.1 搭建页面"></a>5.1 搭建页面</h3><p>放一个容器盛放游戏场景 div#map，设置样式</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#map</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">800px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">600px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-2-分析对象"><a href="#5-2-分析对象" class="headerlink" title="5.2 分析对象"></a>5.2 分析对象</h3><ul>
<li>游戏对象</li>
<li>蛇对象</li>
<li>食物对象</li>
</ul>
<h3 id="5-3-创建食物对象"><a href="#5-3-创建食物对象" class="headerlink" title="5.3 创建食物对象"></a>5.3 创建食物对象</h3><ul>
<li><p>Food</p>
<ul>
<li><p>属性</p>
<ul>
<li>x       </li>
<li>y</li>
<li>width</li>
<li>height</li>
<li>color       </li>
</ul>
</li>
<li><p>方法</p>
<ul>
<li>构造方法</li>
<li>init  随机创建一个食物对象，并输出到map上</li>
<li>remove移除食物的方法</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">window</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> elements = [];<span class="comment">//用来保存每个小方块食物的</span></span><br><span class="line">    <span class="comment">//食物就是一个对象,有宽,有高,有颜色,有横纵坐标,先定义构造函数,然后创建对象</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Food</span>(<span class="params">x, y, width, height, color</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//横纵坐标</span></span><br><span class="line">        <span class="keyword">this</span>.x = x || <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.y = y || <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//宽和高</span></span><br><span class="line">        <span class="keyword">this</span>.width = width || <span class="number">20</span>;</span><br><span class="line">        <span class="keyword">this</span>.height = height || <span class="number">20</span>;</span><br><span class="line">        <span class="comment">//背景颜色</span></span><br><span class="line">        <span class="keyword">this</span>.color = color || <span class="string">"green"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//为原型添加初始化的方法(作用：在页面上显示这个食物)</span></span><br><span class="line">    <span class="comment">//因为食物要在地图上显示,所以,需要地图的这个参数(map---就是页面上的.class=map的这个div)</span></span><br><span class="line">    Food.prototype.init = <span class="function"><span class="keyword">function</span> (<span class="params">map</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//先删除这个小食物</span></span><br><span class="line">        <span class="comment">//外部无法访问的函数</span></span><br><span class="line">        remove();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建div</span></span><br><span class="line">        <span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line">        <span class="comment">//把div加到map中</span></span><br><span class="line">        map.appendChild(div);</span><br><span class="line">        <span class="comment">//设置div的样式</span></span><br><span class="line">        div.style.width = <span class="keyword">this</span>.width + <span class="string">"px"</span>;</span><br><span class="line">        div.style.height = <span class="keyword">this</span>.height + <span class="string">"px"</span>;</span><br><span class="line">        div.style.backgroundColor = <span class="keyword">this</span>.color;</span><br><span class="line">        <span class="comment">//先脱离文档流</span></span><br><span class="line">        div.style.position = <span class="string">"absolute"</span>;</span><br><span class="line">        <span class="comment">//随机横纵坐标</span></span><br><span class="line">        <span class="keyword">this</span>.x = <span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random() * (map.offsetWidth / <span class="keyword">this</span>.width)) * <span class="keyword">this</span>.width;</span><br><span class="line">        <span class="keyword">this</span>.y = <span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random() * (map.offsetHeight / <span class="keyword">this</span>.height)) * <span class="keyword">this</span>.height;</span><br><span class="line">        div.style.left = <span class="keyword">this</span>.x + <span class="string">"px"</span>;</span><br><span class="line">        div.style.top = <span class="keyword">this</span>.y + <span class="string">"px"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//把div加入到数组elements中</span></span><br><span class="line">        elements.push(div);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//私有的函数---删除食物的</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">remove</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//elements数组中有这个食物</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; elements.length; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> ele = elements[i];</span><br><span class="line">            <span class="comment">//找到这个子元素的父级元素,然后删除这个子元素</span></span><br><span class="line">            ele.parentNode.removeChild(ele);</span><br><span class="line">            <span class="comment">//再次把elements中的这个子元素也要删除</span></span><br><span class="line">            elements.splice(i, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//把Food暴露给Window,外部可以使用</span></span><br><span class="line">    <span class="built_in">window</span>.Food = Food;</span><br><span class="line">&#125;(<span class="built_in">window</span>));</span><br></pre></td></tr></table></figure>
<h3 id="5-4-创建蛇对象"><a href="#5-4-创建蛇对象" class="headerlink" title="5.4 创建蛇对象"></a>5.4 创建蛇对象</h3><ul>
<li><p>Snake</p>
</li>
<li><p>属性</p>
<ul>
<li>width    蛇节的宽度 默认20</li>
<li>height   蛇节的高度 默认20</li>
<li>body     数组，蛇的头部和身体，第一个位置是蛇头</li>
<li>direction    蛇运动的方向  默认right  可以是 left  top bottom</li>
</ul>
</li>
<li><p>方法</p>
<ul>
<li>构造方法</li>
<li>init  把蛇渲染到map上</li>
<li>move移动的方法</li>
<li>remove删除小蛇的方法</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//自调用函数---小蛇</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">window</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> elements = [];<span class="comment">//存放小蛇的每个身体部分</span></span><br><span class="line">    <span class="comment">//小蛇的构造函数</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Snake</span>(<span class="params">width, height, direction</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//小蛇的每个部分的宽</span></span><br><span class="line">        <span class="keyword">this</span>.width = width || <span class="number">20</span>;</span><br><span class="line">        <span class="keyword">this</span>.height = height || <span class="number">20</span>;</span><br><span class="line">        <span class="comment">//小蛇的身体</span></span><br><span class="line">        <span class="keyword">this</span>.body = [</span><br><span class="line">            &#123;<span class="attr">x</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">2</span>, <span class="attr">color</span>: <span class="string">"red"</span>&#125;,<span class="comment">//头</span></span><br><span class="line">            &#123;<span class="attr">x</span>: <span class="number">2</span>, <span class="attr">y</span>: <span class="number">2</span>, <span class="attr">color</span>: <span class="string">"orange"</span>&#125;,<span class="comment">//身体</span></span><br><span class="line">            &#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>, <span class="attr">color</span>: <span class="string">"orange"</span>&#125;<span class="comment">//身体</span></span><br><span class="line">        ];</span><br><span class="line">        <span class="comment">//方向</span></span><br><span class="line">        <span class="keyword">this</span>.direction = direction || <span class="string">"right"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//为原型添加方法--小蛇初始化的方法</span></span><br><span class="line">    Snake.prototype.init = <span class="function"><span class="keyword">function</span> (<span class="params">map</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//先删除之前的小蛇</span></span><br><span class="line">        remove();<span class="comment">//===========================================</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//循环遍历创建div</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.body.length; i++) &#123;</span><br><span class="line">            <span class="comment">//数组中的每个数组元素都是一个对象</span></span><br><span class="line">            <span class="keyword">var</span> obj = <span class="keyword">this</span>.body[i];</span><br><span class="line">            <span class="comment">//创建div</span></span><br><span class="line">            <span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line">            <span class="comment">//把div加入到map地图中</span></span><br><span class="line">            map.appendChild(div);</span><br><span class="line">            <span class="comment">//设置div的样式</span></span><br><span class="line">            div.style.position = <span class="string">"absolute"</span>;</span><br><span class="line">            div.style.width = <span class="keyword">this</span>.width + <span class="string">"px"</span>;</span><br><span class="line">            div.style.height = <span class="keyword">this</span>.height + <span class="string">"px"</span>;</span><br><span class="line">            <span class="comment">//横纵坐标</span></span><br><span class="line">            div.style.left = obj.x * <span class="keyword">this</span>.width + <span class="string">"px"</span>;</span><br><span class="line">            div.style.top = obj.y * <span class="keyword">this</span>.height + <span class="string">"px"</span>;</span><br><span class="line">            <span class="comment">//背景颜色</span></span><br><span class="line">            div.style.backgroundColor = obj.color;</span><br><span class="line">            <span class="comment">//方向暂时不定</span></span><br><span class="line">            <span class="comment">//把div加入到elements数组中----目的是为了删除</span></span><br><span class="line">            elements.push(div);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//为原型添加方法---小蛇动起来</span></span><br><span class="line">    Snake.prototype.move = <span class="function"><span class="keyword">function</span> (<span class="params">food, map</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//改变小蛇的身体的坐标位置</span></span><br><span class="line">        <span class="keyword">var</span> i = <span class="keyword">this</span>.body.length - <span class="number">1</span>;<span class="comment">//2</span></span><br><span class="line">        <span class="keyword">for</span> (; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="keyword">this</span>.body[i].x = <span class="keyword">this</span>.body[i - <span class="number">1</span>].x;</span><br><span class="line">            <span class="keyword">this</span>.body[i].y = <span class="keyword">this</span>.body[i - <span class="number">1</span>].y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//判断方向---改变小蛇的头的坐标位置</span></span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">this</span>.direction) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"right"</span>:</span><br><span class="line">                <span class="keyword">this</span>.body[<span class="number">0</span>].x += <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"left"</span>:</span><br><span class="line">                <span class="keyword">this</span>.body[<span class="number">0</span>].x -= <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"top"</span>:</span><br><span class="line">                <span class="keyword">this</span>.body[<span class="number">0</span>].y -= <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"bottom"</span>:</span><br><span class="line">                <span class="keyword">this</span>.body[<span class="number">0</span>].y += <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断有没有吃到食物</span></span><br><span class="line">        <span class="comment">//小蛇的头的坐标和食物的坐标一致</span></span><br><span class="line">        <span class="keyword">var</span> headX=<span class="keyword">this</span>.body[<span class="number">0</span>].x*<span class="keyword">this</span>.width;</span><br><span class="line">        <span class="keyword">var</span> headY=<span class="keyword">this</span>.body[<span class="number">0</span>].y*<span class="keyword">this</span>.height;</span><br><span class="line">        <span class="comment">//判断小蛇的头的坐标和食物的坐标是否相同</span></span><br><span class="line">        <span class="keyword">if</span>(headX==food.x&amp;&amp;headY==food.y)&#123;</span><br><span class="line">            <span class="comment">//获取小蛇的最后的尾巴</span></span><br><span class="line">            <span class="keyword">var</span> last=<span class="keyword">this</span>.body[<span class="keyword">this</span>.body.length<span class="number">-1</span>];</span><br><span class="line">            <span class="comment">//把最后的蛇尾复制一个,重新的加入到小蛇的body中</span></span><br><span class="line">            <span class="comment">//这里面直接复制最后一个就可以了(虽然会导致this.body中两个数组元素一致)，但是随着小蛇的移动(第0个元素坐标给第1个，第1个给第2个，第2个给第3个，坐标会被调整)</span></span><br><span class="line">            <span class="keyword">this</span>.body.push(&#123;</span><br><span class="line">                x:last.x,</span><br><span class="line">                y:last.y,</span><br><span class="line">                color:last.color</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">//把食物删除,重新初始化食物</span></span><br><span class="line">            food.init(map);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//删除小蛇的私有的函数    </span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">remove</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//删除map中的小蛇的每个div,同时删除elements数组中的每个元素,从蛇尾向蛇头方向删除div</span></span><br><span class="line">        <span class="keyword">var</span> i = elements.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="comment">//这边移除元素应该从后面开始移除，如果使用正向for循环，会造成i越来越大而数组长度越来越小，造成一些元素无法移除</span></span><br><span class="line">            <span class="comment">//先从当前的子元素中找到该子元素的父级元素,然后再弄死这个子元素</span></span><br><span class="line">            <span class="keyword">var</span> ele = elements[i];</span><br><span class="line">            <span class="comment">//从map地图上删除这个子元素div</span></span><br><span class="line">            ele.parentNode.removeChild(ele);</span><br><span class="line">            elements.splice(i, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//把Snake暴露给window,外部可以访问</span></span><br><span class="line">    <span class="built_in">window</span>.Snake = Snake;</span><br><span class="line">&#125;(<span class="built_in">window</span>));</span><br></pre></td></tr></table></figure>
<h3 id="5-5-创建游戏对象"><a href="#5-5-创建游戏对象" class="headerlink" title="5.5 创建游戏对象"></a>5.5 创建游戏对象</h3><p>游戏对象，用来管理游戏中的所有对象和开始游戏</p>
<ul>
<li><p>Game</p>
<ul>
<li><p>属性</p>
<ul>
<li><p>food</p>
</li>
<li><p>snake</p>
</li>
<li><p>map</p>
</li>
</ul>
</li>
<li><p>方法</p>
<ul>
<li>Game构造函数</li>
<li>init 初始化方法      将小蛇和食物显示出来</li>
<li>开启定时器，让小蛇移动起来，添加碰撞检测</li>
<li>添加键盘按键信息，方向键控制小蛇上下左右移动</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">;(<span class="function"><span class="keyword">function</span>(<span class="params">win</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//1.构造函数</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Game</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">//地图的信息</span></span><br><span class="line">        <span class="keyword">this</span>.map = my$(<span class="string">"map"</span>);</span><br><span class="line">        <span class="comment">//食物的信息</span></span><br><span class="line">        <span class="keyword">this</span>.food = <span class="keyword">new</span> Food(<span class="number">0</span>,<span class="number">0</span>,<span class="number">20</span>,<span class="number">20</span>,<span class="string">"green"</span>);</span><br><span class="line">        <span class="comment">//蛇的信息</span></span><br><span class="line">        <span class="keyword">this</span>.snake = <span class="keyword">new</span> Snake(<span class="number">20</span>,<span class="number">20</span>,<span class="string">"right"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.添加一个开始游戏的方法</span></span><br><span class="line">    Game.prototype.startGame = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.bindkey();</span><br><span class="line">        <span class="comment">//让食物和小蛇出现在页面</span></span><br><span class="line">        <span class="keyword">this</span>.food.init(<span class="keyword">this</span>.map);</span><br><span class="line">        <span class="keyword">this</span>.snake.init(<span class="keyword">this</span>.map);</span><br><span class="line">        <span class="comment">//开启定时器让小蛇移动</span></span><br><span class="line">        <span class="keyword">var</span> timer = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="comment">//定时器中的this是window对象  console.log(this);</span></span><br><span class="line">            <span class="comment">//使用this来表示当前的游戏对象</span></span><br><span class="line">            <span class="keyword">this</span>.snake.move(<span class="keyword">this</span>.map,<span class="keyword">this</span>.food);</span><br><span class="line">            <span class="comment">//每移动一次需要判断小蛇是否死掉</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//bind方法还会将原函数拷贝一份，同时修改拷贝后的函数中的this指向</span></span><br><span class="line">            <span class="keyword">var</span> aadead = isdead.bind(<span class="keyword">this</span>);</span><br><span class="line">            aadead(timer);</span><br><span class="line">        &#125;.bind(<span class="keyword">this</span>),<span class="number">200</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.判断游戏结束</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isdead</span>(<span class="params">timer</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">        <span class="comment">//什么时候小蛇会挂掉</span></span><br><span class="line">        <span class="comment">//3.1 超出边界</span></span><br><span class="line">        <span class="keyword">var</span> headX = <span class="keyword">this</span>.snake.body[<span class="number">0</span>].x;</span><br><span class="line">        <span class="keyword">var</span> headY = <span class="keyword">this</span>.snake.body[<span class="number">0</span>].y;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(headX&lt;<span class="number">0</span> || headX&gt;=(<span class="keyword">this</span>.map.offsetWidth)/<span class="keyword">this</span>.snake.width)&#123;</span><br><span class="line">            clearInterval(timer);</span><br><span class="line">            alert(<span class="string">"游戏结束"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(headY&lt;<span class="number">0</span> || headY&gt;=<span class="keyword">this</span>.map.offsetHeight/<span class="keyword">this</span>.snake.height)&#123;</span><br><span class="line">            clearInterval(timer);</span><br><span class="line">            alert(<span class="string">"游戏结束"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3.2 头撞身体</span></span><br><span class="line">        <span class="comment">//如何表示头撞身体？ 用头之外的其他所有body和头相比较，如有有任何一个body的坐标和头一致，则说明头撞了身体</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">1</span>;i&lt;<span class="keyword">this</span>.snake.body.length;i++)&#123;</span><br><span class="line">            <span class="keyword">var</span> bodyi = <span class="keyword">this</span>.snake.body[i];</span><br><span class="line">            <span class="comment">//如果头和身体相碰了，就游戏技术</span></span><br><span class="line">            <span class="keyword">if</span>(bodyi.x == headX &amp;&amp; bodyi.y == headY)&#123;</span><br><span class="line">                clearInterval(timer);</span><br><span class="line">                alert(<span class="string">"游戏结束"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.添加方向的控制</span></span><br><span class="line">    <span class="comment">//Game是js对象</span></span><br><span class="line">    <span class="comment">//onkeydown必须要dom对象</span></span><br><span class="line">    Game.prototype.bindkey = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">//给整个文档绑定onkeydown事件</span></span><br><span class="line">        <span class="built_in">document</span>.onkeydown = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">            <span class="comment">//注意点是我们现在的事件添加在document上面，那么此时的this是document对象</span></span><br><span class="line">            <span class="keyword">var</span> oev = e || <span class="built_in">window</span>.event;</span><br><span class="line">            <span class="keyword">switch</span> (oev.keyCode)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">37</span>:</span><br><span class="line">                    <span class="comment">//左</span></span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.snake.direction == <span class="string">"right"</span> || <span class="keyword">this</span>.snake.direction == <span class="string">"left"</span>)&#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">this</span>.snake.direction = <span class="string">"left"</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span>  <span class="number">38</span>:</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.snake.direction == <span class="string">"top"</span> || <span class="keyword">this</span>.snake.direction == <span class="string">"bottom"</span>)&#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">//上</span></span><br><span class="line">                    <span class="keyword">this</span>.snake.direction = <span class="string">"top"</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span>  <span class="number">39</span>:</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.snake.direction == <span class="string">"right"</span> || <span class="keyword">this</span>.snake.direction == <span class="string">"left"</span>)&#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">this</span>.snake.direction = <span class="string">"right"</span>;</span><br><span class="line">                    <span class="comment">//右</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span>  <span class="number">40</span>:</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.snake.direction == <span class="string">"top"</span> || <span class="keyword">this</span>.snake.direction == <span class="string">"bottom"</span>)&#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">//下</span></span><br><span class="line">                    <span class="keyword">this</span>.snake.direction = <span class="string">"bottom"</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.bind(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.将game暴露给window</span></span><br><span class="line">    win.Game = Game;</span><br><span class="line">&#125;(<span class="built_in">window</span>))</span><br></pre></td></tr></table></figure>
<h3 id="5-6-主程序逻辑"><a href="#5-6-主程序逻辑" class="headerlink" title="5.6 主程序逻辑"></a>5.6 主程序逻辑</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//初始化游戏对象</span></span><br><span class="line"><span class="keyword">var</span> gm = <span class="keyword">new</span> Game(<span class="built_in">document</span>.querySelector(<span class="string">".map"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化游戏---开始游戏</span></span><br><span class="line">gm.init();</span><br></pre></td></tr></table></figure>
<h3 id="5-7-其它处理"><a href="#5-7-其它处理" class="headerlink" title="5.7 其它处理"></a>5.7 其它处理</h3><h4 id="5-7-1-将js中代码单独放到一个js文件中"><a href="#5-7-1-将js中代码单独放到一个js文件中" class="headerlink" title="5.7.1 将js中代码单独放到一个js文件中"></a>5.7.1 将js中代码单独放到一个js文件中</h4><p>​    不建议此游戏抽取出太多的js文件，比如Food一个js，Snake一个js，Game一个js。</p>
<p>​    原因主要有：</p>
<p>​    1.多个js文件之间会有引用关系，html页面引入js的时候有顺序要求</p>
<p>​    2.项目部署到服务器的时候，用户通过浏览器请求项目的时候会请求多个js文件，造成网页整体体积变大。</p>
<h4 id="5-7-2-js代码的压缩"><a href="#5-7-2-js代码的压缩" class="headerlink" title="5.7.2 js代码的压缩"></a>5.7.2 js代码的压缩</h4><p>​      我们需要把js代码中的注释、空格等信息压缩，尽可能生成一个比较小的js文件，以供客户端使用</p>
<p>​      <a href="http://tool.oschina.net/jscompress/" target="_blank" rel="noopener">http://tool.oschina.net/jscompress/</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//自调用函数传入window会被压缩</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">window</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">document</span> = <span class="built_in">window</span>.document;</span><br><span class="line"></span><br><span class="line">&#125;(<span class="built_in">window</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">//将来代码压缩的时候，会把 function (window)  压缩成 function (w)</span></span><br></pre></td></tr></table></figure>
<h4 id="5-7-3-函数内-this-指向的不同场景"><a href="#5-7-3-函数内-this-指向的不同场景" class="headerlink" title="5.7.3 函数内 this 指向的不同场景"></a>5.7.3 函数内 <code>this</code> 指向的不同场景</h4><p>​    函数的调用方式决定了 <code>this</code> 指向的不同：</p>
<table>
<thead>
<tr>
<th>调用方式</th>
<th>非严格模式</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>普通函数调用</td>
<td>window</td>
<td>严格模式(“use strict”;)下是 undefined</td>
</tr>
<tr>
<td>构造函数调用</td>
<td>实例对象</td>
<td>原型方法中 this 也是实例对象</td>
</tr>
<tr>
<td>对象方法调用</td>
<td>该方法所属对象</td>
<td></td>
</tr>
<tr>
<td>事件绑定方法</td>
<td>绑定事件对象</td>
<td></td>
</tr>
<tr>
<td>定时器函数</td>
<td>window</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//普通函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);   <span class="comment">//this 指的是window对象</span></span><br><span class="line">&#125;</span><br><span class="line">f1(); <span class="comment">//调用函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;  <span class="comment">//this指的是实例对象</span></span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="keyword">this</span>.say = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="built_in">console</span>.log(<span class="keyword">this</span>); <span class="comment">//this是调用say方法所属对象</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person(<span class="string">"张三"</span>,<span class="number">19</span>);  <span class="comment">//通过new调用构造函数创建对象</span></span><br><span class="line">p.say(); <span class="comment">//通过对象调用实例方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定时器</span></span><br><span class="line">setTimeInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="keyword">this</span>);   <span class="comment">//this 指的是window对象</span></span><br><span class="line">&#125;,<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//一句话：this指的是方法的调用者 .</span></span><br><span class="line"><span class="comment">//比如  window.f1()     f1函数中的this就是window</span></span><br></pre></td></tr></table></figure>
<h2 id="6-继承"><a href="#6-继承" class="headerlink" title="6. 继承"></a>6. 继承</h2><h3 id="6-1-神奇的原型链"><a href="#6-1-神奇的原型链" class="headerlink" title="6.1 神奇的原型链"></a>6.1 神奇的原型链</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> divObj=<span class="built_in">document</span>.getElementById(<span class="string">"dv"</span>);</span><br><span class="line"><span class="built_in">console</span>.dir(divObj);</span><br><span class="line"></span><br><span class="line"><span class="comment">//divObj.__proto__----&gt;HTMLDivElement.prototype</span></span><br><span class="line"><span class="comment">//HTMLDivElement.prototype的__proto__---&gt;HTMLElement.prototype</span></span><br><span class="line"><span class="comment">//HTMLElement.prototype的__proto__----&gt;Element.prototype</span></span><br><span class="line"><span class="comment">//Element.prototype的__proto__----&gt;Node.prototype</span></span><br><span class="line"><span class="comment">//Node.prototype的__proto__----&gt;EventTarget.prototype</span></span><br><span class="line"><span class="comment">//EventTarget.prototype的__proto__----&gt;Object.prototype</span></span><br><span class="line"><span class="comment">//Object.prototype中的__proto__是null</span></span><br></pre></td></tr></table></figure>
<h3 id="6-2-原型链详解"><a href="#6-2-原型链详解" class="headerlink" title="6.2 原型链详解"></a>6.2 原型链详解</h3><p>​    构造函数的原型属性(prototype)中，除了拥有构造方法constructor之外，还有一个<strong> proto </strong>属性，该属性指向父亲的原型对象(prototype)。</p>
<p>​    对象的<strong> proto </strong>属性指向了函数的原型，就构成了原型链。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.eat=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"吃东西"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> per=<span class="keyword">new</span> Person();</span><br><span class="line"><span class="built_in">console</span>.dir(per);<span class="comment">//实例对象的结构</span></span><br><span class="line"><span class="built_in">console</span>.dir(Person);<span class="comment">//构造函数的结构</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//实例对象中有__proto__原型</span></span><br><span class="line"><span class="comment">//构造函数中有prototype原型</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">//prototype是对象</span></span><br><span class="line"><span class="comment">//所以,prototype这个对象中也有__proto__,那么指向了哪里</span></span><br><span class="line"><span class="comment">//实例对象中的__proto__指向的是构造函数的prototype</span></span><br><span class="line"><span class="comment">//所以,prototype这个对象中__proto__指向的应该是某个构造函数的原型prototype</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(Person.prototype.__proto__ == <span class="built_in">Object</span>.prototype)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.__proto__)   <span class="comment">//null</span></span><br></pre></td></tr></table></figure>
<p><img src="media\1537518607776.png" alt="1537518607776"></p>
<p><img src="media\原型最终的指向.png" alt></p>
<h3 id="6-3-什么是继承"><a href="#6-3-什么是继承" class="headerlink" title="6.3 什么是继承"></a>6.3 什么是继承</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   * 面向对象编程思想:根据需求,分析对象,找到对象有什么特征和行为,通过代码的方式来实现需求,要想实现这个需求,就要创建对象,要想创建对象,就应该显示有构造函数,然后通过构造函数来创建对象.,通过对象调用属性和方法来实现相应的功能及需求,即可</span></span><br><span class="line"><span class="comment">   * 首先JS不是一门面向对象的语言,JS是一门基于对象的语言,那么为什么学习js还要学习面向对象,因为面向对象的思想适合于人的想法,编程起来会更加的方便,及后期的维护....</span></span><br><span class="line"><span class="comment">   * 面向对象的编程语言中有类(class)的概念(也是一种特殊的数据类型),但是JS不是面向对象的语言,所以,JS中没有类(class),但是JS可以模拟面向对象的思想编程,JS中会通过构造函数来模拟类的概念(class)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   * 小明,小红，小丽，小白，小花 都是人</span></span><br><span class="line"><span class="comment">   * 共同的特征和行为</span></span><br><span class="line"><span class="comment">   * 特征---&gt;属性</span></span><br><span class="line"><span class="comment">   * 行为---方法</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   * 面向对象的特性:封装,继承,多态</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   * 封装:就是包装</span></span><br><span class="line"><span class="comment">   * 一坨重复代码放在一个函数中--封装</span></span><br><span class="line"><span class="comment">   * 一系列的属性放在一个对象中--封装</span></span><br><span class="line"><span class="comment">   * 一些功能类似的函数(方法)放在一个对象中--封装</span></span><br><span class="line"><span class="comment">   * 好多相类似的对象放在一个js文件中---封装</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   * 继承: 首先继承是一种关系,类(class)与类之间的关系,JS中没有类,但是可以通过构造函数模拟类,然后通过原型来实现继承</span></span><br><span class="line"><span class="comment">   * 继承也是为了数据共享,js中的继承也是为了实现数据共享</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   * 原型作用之一:数据共享,节省内存空间</span></span><br><span class="line"><span class="comment">   * 原型作用之二:为了实现继承</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   * 继承是一种关系:</span></span><br><span class="line"><span class="comment">   * 父类级别与类级别的关系</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   * 例子:</span></span><br><span class="line"><span class="comment">   * 人:  姓名, 性别, 年龄 ,吃饭, 睡觉</span></span><br><span class="line"><span class="comment">   * 学生类别: 姓名, 性别, 年龄 ,吃饭, 睡觉 学习行为</span></span><br><span class="line"><span class="comment">   * 老师类别: 姓名, 性别, 年龄 ,吃饭, 睡觉 工资,教学行为</span></span><br><span class="line"><span class="comment">   * 程序员: 姓名, 性别, 年龄 ,吃饭, 睡觉 工资, 敲代码</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   * 动物类别:  体重， 颜色, 吃</span></span><br><span class="line"><span class="comment">   * 狗类别:   体重,颜色, 吃, 咬人</span></span><br><span class="line"><span class="comment">   * 猫类别: 体重,颜色, 吃, 咬人 逗主人开心,你好帅</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   * 多态:一个对象有不同的行为,或者是同一个行为针对不同的对象,产生不同的结果,要想有多态,就要先有继承*/</span></span><br></pre></td></tr></table></figure>
<h3 id="6-4-原型继承"><a href="#6-4-原型继承" class="headerlink" title="6.4 原型继承"></a>6.4 原型继承</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//继承例子:</span></span><br><span class="line"><span class="comment">//人,都有姓名,性别,年龄, 吃饭, 睡觉, 玩</span></span><br><span class="line"><span class="comment">//学生,都有姓名,性别,年龄, 成绩, 吃饭, 睡觉, 玩 ,学习的行为</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//js中通过原型来实现继承</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age=age;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.eat=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"人可以吃东西"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">score</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.score=score;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在改变学生原型对象之前先给学生的原型中添加一个sayHi方法(这个方法会出现什么情况?)</span></span><br><span class="line">Student.prototype.sayHi = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"hi~~~"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//改变学生的原型的指向即可==========&gt;学生和人已经发生关系</span></span><br><span class="line">Student.prototype = <span class="keyword">new</span> Person(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//相同的代码太多,造成了代码的冗余(重复的代码)</span></span><br><span class="line"><span class="keyword">var</span> stu=<span class="keyword">new</span> Student(<span class="number">100</span>);</span><br><span class="line"><span class="built_in">console</span>.log(stu.age);</span><br><span class="line">stu.eat();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"下面的是学生对象中自己有的"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(stu.score);</span><br><span class="line">stu.sayHi();<span class="comment">//错误?</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//一般步骤是：先修改函数原型，再向修改后的原型中添加信息</span></span><br></pre></td></tr></table></figure>
<p><img src="media\原型链指向改变.png" alt></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//继承案例</span></span><br><span class="line"><span class="comment">//动物有名字,有体重,有吃东西的行为</span></span><br><span class="line"><span class="comment">//小狗有名字,有体重,有毛色, 有吃东西的行为,还有咬人的行为</span></span><br><span class="line"><span class="comment">//哈士奇名字,有体重,有毛色,性别, 有吃东西的行为,还有咬人的行为,逗主人开心的行为</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//动物的构造韩素</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params">name,weight</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name=name;</span><br><span class="line">    <span class="keyword">this</span>.weight=weight;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//动物的原型的方法</span></span><br><span class="line">Animal.prototype.eat=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"天天吃东西,就是吃"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//狗的构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog</span>(<span class="params">color</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.color=color;</span><br><span class="line">&#125;</span><br><span class="line">Dog.prototype=<span class="keyword">new</span> Animal(<span class="string">"哮天犬"</span>,<span class="string">"50kg"</span>);</span><br><span class="line">Dog.prototype.bitePerson=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"哼~汪汪~咬死你"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//哈士奇</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ErHa</span>(<span class="params">sex</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.sex=sex;</span><br><span class="line">&#125;</span><br><span class="line">ErHa.prototype=<span class="keyword">new</span> Dog(<span class="string">"黑白色"</span>);</span><br><span class="line">ErHa.prototype.playHost=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"哈哈~要坏衣服,要坏桌子,拆家..嘎嘎...好玩,开心不,惊喜不,意外不"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> erHa=<span class="keyword">new</span> ErHa(<span class="string">"雄性"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(erHa.name,erHa.weight,erHa.color);</span><br><span class="line">erHa.eat();</span><br><span class="line">erHa.bitePerson();</span><br><span class="line">erHa.playHost();</span><br></pre></td></tr></table></figure>
<p><img src="media\原型链的图解.png" alt></p>
<h3 id="6-5-构造函数的属性继承"><a href="#6-5-构造函数的属性继承" class="headerlink" title="6.5 构造函数的属性继承"></a>6.5 构造函数的属性继承</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//上面原型继承中为了数据共享,改变原型指向,做到了继承  ---通过改变原型指向实现的继承</span></span><br><span class="line"><span class="comment">//缺陷:因为改变原型指向的同时实现继承,直接初始化了属性，继承过来的属性的值都是一样的了,所以,这就是问题只能重新调用对象的属性进行重新赋值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//解决方案:继承的时候,不用改变原型的指向,直接调用父级的构造函数的方式来为属性赋值就可以了  ------借用构造函数:把要继承的父级的构造函数拿过来,使用一下就可以了</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.type = <span class="string">'human'</span></span><br><span class="line">  <span class="keyword">this</span>.name = name</span><br><span class="line">  <span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 借用构造函数继承属性成员</span></span><br><span class="line">  Person.call(<span class="keyword">this</span>, name, age)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s1 = Student(<span class="string">'张三'</span>, <span class="number">18</span>)</span><br><span class="line"><span class="built_in">console</span>.log(s1.type, s1.name, s1.age) <span class="comment">// =&gt; human 张三 18</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//借用构造函数:构造函数名字.call(当前对象,属性,属性,属性....);</span></span><br><span class="line"><span class="comment">//解决了属性继承,并且值不重复的问题</span></span><br><span class="line"><span class="comment">//缺陷:父级类别中的方法不能继承</span></span><br></pre></td></tr></table></figure>
<h3 id="6-6-组合继承"><a href="#6-6-组合继承" class="headerlink" title="6.6 组合继承"></a>6.6 组合继承</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//组合继承:原型继承+借用构造函数继承</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age,sex</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name=name;</span><br><span class="line">    <span class="keyword">this</span>.age=age;</span><br><span class="line">    <span class="keyword">this</span>.sex=sex;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sayHi=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"阿涅哈斯诶呦"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name,age,sex,score</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//借用构造函数:属性值重复的问题</span></span><br><span class="line">    Person.call(<span class="keyword">this</span>,name,age,sex);</span><br><span class="line">    <span class="keyword">this</span>.score=score;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//改变原型指向----继承</span></span><br><span class="line">Student.prototype=<span class="keyword">new</span> Person();<span class="comment">//不传值</span></span><br><span class="line">Student.prototype.eat=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"吃东西"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//此时的"小黑",20,"男","100分" 都是属于对象的信息，不是原型的信息</span></span><br><span class="line"><span class="keyword">var</span> stu=<span class="keyword">new</span> Student(<span class="string">"小黑"</span>,<span class="number">20</span>,<span class="string">"男"</span>,<span class="string">"100分"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(stu.name,stu.age,stu.sex,stu.score);</span><br><span class="line">stu.sayHi();</span><br><span class="line">stu.eat();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stu2=<span class="keyword">new</span> Student(<span class="string">"小黑黑"</span>,<span class="number">200</span>,<span class="string">"男人"</span>,<span class="string">"1010分"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(stu2.name,stu2.age,stu2.sex,stu2.score);</span><br><span class="line">stu2.sayHi();</span><br><span class="line">stu2.eat();</span><br><span class="line"></span><br><span class="line"><span class="comment">//属性和方法都被继承了</span></span><br><span class="line"><span class="comment">//推荐使用</span></span><br></pre></td></tr></table></figure>
<h3 id="6-7-构造函数的属性继承-拷贝继承"><a href="#6-7-构造函数的属性继承-拷贝继承" class="headerlink" title="6.7 构造函数的属性继承+拷贝继承"></a>6.7 构造函数的属性继承+拷贝继承</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.type = <span class="string">'human'</span></span><br><span class="line">  <span class="keyword">this</span>.name = name</span><br><span class="line">  <span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'hello '</span> + <span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  Person.call(<span class="keyword">this</span>, name, age)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 原型对象拷贝继承原型对象成员</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> Person.prototype) &#123;</span><br><span class="line">  Student.prototype[key] = Person.prototype[key]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s1 = Student(<span class="string">'张三'</span>, <span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">s1.sayName() <span class="comment">// =&gt; hello 张三</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//效率较低，内存占用高（因为要拷贝父类的属性）</span></span><br><span class="line"><span class="comment">//无法获取父类不可枚举的方法（不可枚举方法，不能使用for in 访问到）</span></span><br><span class="line"><span class="comment">//不推荐使用</span></span><br></pre></td></tr></table></figure>
<h3 id="6-8-逆推继承看原型"><a href="#6-8-逆推继承看原型" class="headerlink" title="6.8 逆推继承看原型"></a>6.8 逆推继承看原型</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F1</span>(<span class="params">age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F2</span>(<span class="params">age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">F2.prototype = <span class="keyword">new</span> F1(<span class="number">10</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F3</span>(<span class="params">age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line">F3.prototype = <span class="keyword">new</span> F2(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> f3 = <span class="keyword">new</span> F3(<span class="number">30</span>);</span><br><span class="line"><span class="built_in">console</span>.log(f3.age);<span class="comment">//</span></span><br></pre></td></tr></table></figure>
<p><img src="media\逆推继承看原型.png" alt></p>
<h3 id="6-9-属性成员的搜索原则"><a href="#6-9-属性成员的搜索原则" class="headerlink" title="6.9 属性成员的搜索原则"></a>6.9 属性成员的搜索原则</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//当实例对象和原型中都有sex信息的时候，访问对象的属性获取的是谁的信息呢？</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">age,sex</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age=age;</span><br><span class="line">    <span class="keyword">this</span>.sex=sex;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sex=<span class="string">"女"</span>;</span><br><span class="line"><span class="keyword">var</span> per=<span class="keyword">new</span> Person(<span class="number">10</span>,<span class="string">"男"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(per.sex);</span><br></pre></td></tr></table></figure>
<p>​    每当代码读取某个对象的某个属性时，都会执行一次搜索，目标是具有给定名字的属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 搜索首先从对象实例本身开始</span><br><span class="line">2. 如果在实例中找到了具有给定名字的属性，则返回该属性的值</span><br><span class="line">3. 如果没有找到，则继续搜索指针指向的原型对象，在原型对象中查找具有给定名字的属性</span><br><span class="line">4. 如果在原型对象中找到了这个属性，则返回该属性的值</span><br><span class="line">5. 如果在原型对象中没有找到这个属性，则继续从父亲的原型中查找，有就返回</span><br></pre></td></tr></table></figure>
<p>​    也就是说，在我们调用   <code>per.sex</code> 的时候，会先后执行两次搜索：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 首先，解析器会问：“实例 per 有 sex 属性吗？”答：“没有。</span><br><span class="line"><span class="number">2.</span> 然后，它继续搜索，再问：“ per 的原型有 sex 属性吗？”答：“没有。</span><br><span class="line"><span class="number">3.</span> 于是，它就从父亲的原型中查找有没有sex</span><br></pre></td></tr></table></figure>
<p>​    而这正是多个对象实例共享原型所保存的属性和方法的基本原理。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">总结：</span><br><span class="line">1. 先在自己身上找，找到即返回</span><br><span class="line">2. 自己身上找不到，则沿着原型链向上查找，找到即返回</span><br><span class="line">3. 如果一直到原型链的末端还没有找到，则返回 undefined</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="7-函数进阶"><a href="#7-函数进阶" class="headerlink" title="7. 函数进阶"></a>7. 函数进阶</h2><h3 id="7-1-函数的定义方式"><a href="#7-1-函数的定义方式" class="headerlink" title="7.1 函数的定义方式"></a>7.1 函数的定义方式</h3><ul>
<li>函数声明</li>
<li>函数表达式(匿名函数)</li>
<li>自调用函数</li>
<li><code>new Function</code></li>
</ul>
<h4 id="7-1-1-函数声明"><a href="#7-1-1-函数声明" class="headerlink" title="7.1.1 函数声明"></a>7.1.1 函数声明</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="7-1-2-函数表达式"><a href="#7-1-2-函数表达式" class="headerlink" title="7.1.2 函数表达式"></a>7.1.2 函数表达式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="7-1-3-函数声明与函数表达式的区别"><a href="#7-1-3-函数声明与函数表达式的区别" class="headerlink" title="7.1.3 函数声明与函数表达式的区别"></a>7.1.3 函数声明与函数表达式的区别</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.函数声明必须有名字</span><br><span class="line">2.函数声明会函数提升，在预解析阶段就已创建，声明前后都可以调用</span><br><span class="line">3.函数表达式类似于变量赋值</span><br><span class="line">4.函数表达式可以没有名字，例如匿名函数</span><br><span class="line">5.函数表达式没有变量提升，在执行阶段创建，必须在表达式执行之后才可以调用</span><br></pre></td></tr></table></figure>
<p>​    下面是一个根据条件定义函数的例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        alert(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">f();</span><br><span class="line"><span class="comment">//函数声明如果写在if else中，不同浏览器会有不同的结果</span></span><br><span class="line"><span class="comment">//谷歌报错 ：f is not a function</span></span><br><span class="line"><span class="comment">//ie8  alert(1)</span></span><br><span class="line"><span class="comment">//说明不同浏览器的预解析规则不太一样</span></span><br></pre></td></tr></table></figure>
<p>​    不过我们可以使用函数表达式解决上面的问题：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> f</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">false</span>) &#123;</span><br><span class="line">  f = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//函数表达式不会像函数声明一样被强行提升</span></span><br></pre></td></tr></table></figure>
<h4 id="7-1-4-new-Function"><a href="#7-1-4-new-Function" class="headerlink" title="7.1.4 new Function()"></a>7.1.4 new Function()</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//所有的函数实际上都是Function的构造函数创建出来的实例对象</span></span><br><span class="line"><span class="keyword">var</span> f1 = <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">"num1"</span>,<span class="string">"num2"</span>,<span class="string">"return num1+num2"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="7-2-函数也是对象"><a href="#7-2-函数也是对象" class="headerlink" title="7.2 函数也是对象"></a>7.2 函数也是对象</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>所有函数都是 <span class="built_in">Function</span> 的实例，所以函数也是对象(对象拥有 __proto__ 属性)，函数拥有prototype属性</span><br><span class="line"><span class="number">2.</span><span class="built_in">console</span>.dir(f1)    打印函数</span><br><span class="line"><span class="number">3.</span>所有的函数实际上都是<span class="built_in">Function</span>的构造函数创建出来的实例对象</span><br><span class="line">  f1.__proto__ == <span class="built_in">Function</span>.prototype    <span class="comment">//结果为true，函数的__proto__指向了Function的prototype</span></span><br><span class="line"><span class="number">4.</span><span class="built_in">console</span>.dir(<span class="built_in">Function</span>)   <span class="built_in">Function</span>既是一个函数也是一个对象，其实<span class="keyword">var</span> <span class="built_in">Function</span> = <span class="keyword">new</span> <span class="built_in">Function</span>()，这里就不讨论了。</span><br><span class="line">  <span class="built_in">Function</span>.prototype.__proto__ == <span class="built_in">Object</span>.prototype   <span class="comment">//Function的prototype中的__proto__最终都指向了Object的原型</span></span><br><span class="line"><span class="number">5.</span><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.__proto__);  <span class="comment">//null</span></span><br></pre></td></tr></table></figure>
<p><img src="media\hanshuyuanxing.png" alt></p>
<h3 id="7-3-call、apply、bind：作用可以改变函数this的指向"><a href="#7-3-call、apply、bind：作用可以改变函数this的指向" class="headerlink" title="7.3 call、apply、bind：作用可以改变函数this的指向"></a>7.3 call、apply、bind：作用可以改变函数this的指向</h3><h4 id="7-3-1-call"><a href="#7-3-1-call" class="headerlink" title="7.3.1 call"></a>7.3.1 call</h4><p><code>call()</code> 方法调用一个函数, 其具有一个指定的 <code>this</code> 值和分别地提供的参数(参数的列表)。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//语法：fun.call(thisArg,args...)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>(a+b);</span><br><span class="line">    <span class="built_in">console</span>(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line">f1.call(<span class="literal">null</span>,<span class="number">100</span>,<span class="number">200</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*参数：</span></span><br><span class="line"><span class="comment">1. thisArg</span></span><br><span class="line"><span class="comment">    在函数运行时指定的 this 值</span></span><br><span class="line"><span class="comment">    如果指定了 null 或者 undefined 则内部 this 指向 window</span></span><br><span class="line"><span class="comment">2.arg1, arg2, ...</span></span><br><span class="line"><span class="comment">    指定的参数列表</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h4 id="7-3-2-apply"><a href="#7-3-2-apply" class="headerlink" title="7.3.2 apply"></a>7.3.2 apply</h4><p><code>apply()</code> 方法调用一个函数, 其具有一个指定的 <code>this</code> 值，以及作为一个数组（或类似数组的对象）提供的参数。</p>
<p>  注意：该方法的作用和 <code>call()</code> 方法类似，只有一个区别，就是 <code>call()</code> 方法接受的是若干个参数的列表，而 <code>apply()</code> 方法接受的是一个包含多个参数的数组。</p>
<p>语法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">fun.apply(thisArg, [argsArray])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>(a+b);</span><br><span class="line">    <span class="built_in">console</span>(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line">f1.call(<span class="literal">null</span>,[<span class="number">100</span>,<span class="number">200</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">参数：</span></span><br><span class="line"><span class="comment">1. thisArg</span></span><br><span class="line"><span class="comment">2. argsArray</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><code>apply()</code> 与 <code>call()</code> 非常相似，不同之处在于提供参数的方式。<br><code>apply()</code> 使用参数数组而不是一组参数列表。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用apply和call改变函数中this的指向</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params">x,y</span>) </span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"这个函数是window对象的一个方法:"</span>+(x+y)+<span class="keyword">this</span>.sex);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.f1(<span class="number">10</span>,<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//obj是一个对象</span></span><br><span class="line"><span class="keyword">var</span> obj=&#123;</span><br><span class="line">     age:<span class="number">10</span>,</span><br><span class="line">     sex:<span class="string">"男"</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.f1.apply(obj,[<span class="number">10</span>,<span class="number">20</span>]);</span><br><span class="line"><span class="built_in">window</span>.f1.call(obj,<span class="number">10</span>,<span class="number">20</span>);</span><br><span class="line"><span class="built_in">console</span>.dir(obj);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过apply和call改变原型方法中this的指向</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">age,sex</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age=age;</span><br><span class="line">    <span class="keyword">this</span>.sex=sex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//通过原型添加方法</span></span><br><span class="line">Person.prototype.sayHi=<span class="function"><span class="keyword">function</span> (<span class="params">x,y</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"您好啊:"</span>+<span class="keyword">this</span>.sex);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1000</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> per=<span class="keyword">new</span> Person(<span class="number">10</span>,<span class="string">"男"</span>);</span><br><span class="line">per.sayHi();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"=============="</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name,sex</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name=name;</span><br><span class="line">    <span class="keyword">this</span>.sex=sex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> stu=<span class="keyword">new</span> Student(<span class="string">"小明"</span>,<span class="string">"人妖"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> r1=per.sayHi.apply(stu,[<span class="number">10</span>,<span class="number">20</span>]);</span><br><span class="line"><span class="keyword">var</span> r2=per.sayHi.call(stu,<span class="number">10</span>,<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(r1);</span><br><span class="line"><span class="built_in">console</span>.log(r2);</span><br></pre></td></tr></table></figure>
<h4 id="7-3-3-apply和call方法的由来"><a href="#7-3-3-apply和call方法的由来" class="headerlink" title="7.3.3 apply和call方法的由来"></a>7.3.3 apply和call方法的由来</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>+<span class="string">":====&gt;调用了"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//f1是函数,f1也是对象</span></span><br><span class="line"><span class="built_in">console</span>.dir(f1);</span><br><span class="line"></span><br><span class="line"><span class="comment">//对象调用方法,说明,该对象中有这个方法</span></span><br><span class="line">f1.apply();</span><br><span class="line">f1.call();</span><br><span class="line"><span class="built_in">console</span>.log(f1.__proto__==<span class="built_in">Function</span>.prototype);</span><br><span class="line"></span><br><span class="line"><span class="comment">//所有的函数都是Function的实例对象</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Function</span>.prototype);<span class="comment">//ƒ () &#123; [native code] &#125;</span></span><br><span class="line"><span class="built_in">console</span>.dir(<span class="built_in">Function</span>);</span><br><span class="line"><span class="comment">//apply和call方法实际上并不在函数这个实例对象中,而是在Function的prototype中</span></span><br></pre></td></tr></table></figure>
<h4 id="7-3-4-bind"><a href="#7-3-4-bind" class="headerlink" title="7.3.4 bind"></a>7.3.4 bind</h4><p>​    bind函数是复制函数，在复制函数的时候改变了this的指向</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//语法：fun.bind(thisArg,args...)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params">x,y</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x+y);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.age);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age = <span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> per = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="keyword">var</span> ff = f1.bind(per,<span class="number">10</span>,<span class="number">20</span>);  <span class="comment">//这边将f1函数复制了一份，同时改变了f1函数中this的指向</span></span><br><span class="line">ff();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1.参数：</span></span><br><span class="line"><span class="comment">  1.1 thisArg</span></span><br><span class="line"><span class="comment">      当绑定函数被调用时，该参数会作为原函数运行时的 this 指向。当使用new 操作符调用绑定函数时，该参数无效。</span></span><br><span class="line"><span class="comment">  1.2 arg1, arg2, ...</span></span><br><span class="line"><span class="comment">      当绑定函数被调用时，这些参数将置于实参之前传递给被绑定的方法。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2.返回值：返回由指定的this值和初始化参数改造的原函数拷贝</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p>示例1：对象方法中this的修改</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age=age;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.play=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>+<span class="string">"====&gt;"</span>+<span class="keyword">this</span>.age);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age=age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> per=<span class="keyword">new</span> Person(<span class="number">10</span>);</span><br><span class="line"><span class="keyword">var</span> stu=<span class="keyword">new</span> Student(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//复制了一份</span></span><br><span class="line"><span class="keyword">var</span> ff=per.play.bind(stu);</span><br><span class="line">ff();</span><br></pre></td></tr></table></figure>
<p>示例2：返回函数中this的修改</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.x = <span class="number">9</span>; </span><br><span class="line"><span class="keyword">var</span> <span class="built_in">module</span> = &#123;</span><br><span class="line">  x: <span class="number">81</span>,</span><br><span class="line">  getX: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.x; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.getX(); <span class="comment">// 返回 81</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> retrieveX = <span class="built_in">module</span>.getX;</span><br><span class="line">retrieveX(); <span class="comment">// 返回 9, 在这种情况下，"this"指向全局作用域</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个新函数，将"this"绑定到module对象</span></span><br><span class="line"><span class="comment">// 新手可能会被全局的x变量和module里的属性x所迷惑</span></span><br><span class="line"><span class="keyword">var</span> boundGetX = retrieveX.bind(<span class="built_in">module</span>);</span><br><span class="line">boundGetX(); <span class="comment">// 返回 81</span></span><br></pre></td></tr></table></figure>
<p>示例3：定时器函数中this修改</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ShowRandom</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    ShowRandom.prototype.showRandom = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">//通过bind方法来修改定时器中this指向</span></span><br><span class="line">        <span class="keyword">var</span> timer = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> num = <span class="keyword">this</span>.produceNum();</span><br><span class="line">            <span class="built_in">console</span>.log(num);</span><br><span class="line">        &#125;.bind(<span class="keyword">this</span>),<span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    ShowRandom.prototype.produceNum = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random()*<span class="number">10</span>+<span class="number">1</span>);<span class="comment">//1~10的随机数</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> s = <span class="keyword">new</span> ShowRandom();</span><br><span class="line">    s.showRandom();</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="7-3-5-小结"><a href="#7-3-5-小结" class="headerlink" title="7.3.5 小结"></a>7.3.5 小结</h4><ul>
<li><p>call 和 apply 特性一样</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.都是用来调用函数，而且是立即调用</span><br><span class="line">2.但是可以在调用函数的同时，通过第一个参数指定函数内部 this 的指向</span><br><span class="line">3.call 调用的时候，参数必须以参数列表的形式进行传递，也就是以逗号分隔的方式依次传递即可</span><br><span class="line">4.apply 调用的时候，参数必须是一个数组，然后在执行的时候，会将数组内部的元素一个一个拿出来，与形参一一对应进行传递</span><br><span class="line">5.如果第一个参数指定了 null 或者 undefined 则内部 this 指向 window</span><br></pre></td></tr></table></figure>
</li>
<li><p>bind</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.可以用来指定内部 this 的指向，然后生成一个改变了 this 指向的新的函数</span><br><span class="line">2.它和 call、apply 最大的区别是：bind 不会调用</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="7-4-数组中存放函数"><a href="#7-4-数组中存放函数" class="headerlink" title="7.4 数组中存放函数"></a>7.4 数组中存放函数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//数组可以存储任何类型的数据</span></span><br><span class="line"><span class="keyword">var</span> arr=[</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"十一假期快乐"</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"十一假期开心"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"十一假期健康"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"十一假期安全"</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"十一假期如意"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">];</span><br><span class="line"><span class="comment">//回调函数:函数作为参数使用</span></span><br><span class="line">arr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">ele</span>) </span>&#123;</span><br><span class="line">    ele();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="7-5-函数的其它成员"><a href="#7-5-函数的其它成员" class="headerlink" title="7.5 函数的其它成员"></a>7.5 函数的其它成员</h3><ul>
<li>arguments  实参集合</li>
<li>length  形参的个数</li>
<li>name  函数的名称</li>
<li>caller  函数的调用者</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">x, y, z</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(fn.length) <span class="comment">// =&gt; 形参的个数</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>) <span class="comment">// 伪数组实参参数集合</span></span><br><span class="line">  <span class="built_in">console</span>.log(fn.caller) <span class="comment">// 获取调用当前函数的函数</span></span><br><span class="line">  <span class="built_in">console</span>.log(fn.name) <span class="comment">// =&gt; 函数的名字</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  fn(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f()</span><br></pre></td></tr></table></figure>
<h4 id="7-5-1-什么是伪数组"><a href="#7-5-1-什么是伪数组" class="headerlink" title="7.5.1 什么是伪数组"></a>7.5.1 什么是伪数组</h4><p>​    伪数组，就是像数组一样有 <code>length</code> 属性，也有 <code>0、1、2、3</code> 等属性的对象，看起来就像数组一样，但不是数。</p>
<p>​    伪数组特点：</p>
<p>​    1.拥有 length 属性。但是其length属性不会像真正的数组一样随着元素的添加删除自动更新</p>
<p>​    2.可以遍历伪数组，但是不具备数组的方法  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fakeArray = &#123;</span><br><span class="line">  <span class="string">"0"</span>: <span class="string">"first"</span>,</span><br><span class="line">  <span class="string">"1"</span>: <span class="string">"second"</span>,</span><br><span class="line">  <span class="string">"2"</span>: <span class="string">"third"</span>,</span><br><span class="line">  length: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">delete</span> fakeArray[<span class="string">"2"</span>]; <span class="comment">//fakeArray中的length不会发生更新</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; fakeArray.length; i++) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(fakeArray[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 此时fakeArray虽然具备length属性，但是不能直接调用数组的方法</span></span><br><span class="line"><span class="comment">// 伪数组存在的意义，是可以让普通的对象也能正常使用数组的很多算法,比如：</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.join.call(fakeArray,<span class="string">'+'</span>);</span><br><span class="line"><span class="built_in">Array</span>.prototype.push.call(fakeArray, <span class="string">'d'</span>)</span><br><span class="line"><span class="comment">//上面代码的含义：当前的fakeArray对象没有join方法，但是Array.prototype中有，可以将Array.prototype.join中的this改为当前的fakeArray，然后用"+"号进行拼接</span></span><br></pre></td></tr></table></figure>
<h4 id="7-5-2-常见的伪数组"><a href="#7-5-2-常见的伪数组" class="headerlink" title="7.5.2 常见的伪数组"></a>7.5.2 常见的伪数组</h4><ul>
<li>函数内部的 <code>arguments</code></li>
<li>DOM 对象列表（比如通过 <code>document.getElementsByTags</code> 得到的列表）</li>
<li>jQuery 对象（比如 <code>$(&quot;div&quot;)</code> ）</li>
</ul>
<h4 id="7-5-3-小结"><a href="#7-5-3-小结" class="headerlink" title="7.5.3 小结"></a>7.5.3 小结</h4><ul>
<li>伪数组是一个 Object，没有数组 Array.prototype 的属性值，而真实的数组是一个 Array。</li>
<li>数组是基于索引的实现， length 会自动更新；而Object对象是键值对</li>
<li>伪数组不可以直接调用数组的方法，但是可以通过原型call方式间接调用数组中的方法</li>
</ul>
<h3 id="7-6-函数递归"><a href="#7-6-函数递归" class="headerlink" title="7.6 函数递归"></a>7.6 函数递归</h3><h4 id="7-6-1-递归执行模型"><a href="#7-6-1-递归执行模型" class="headerlink" title="7.6.1 递归执行模型"></a>7.6.1 递归执行模型</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn1</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">111</span>)</span><br><span class="line">  fn2()</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'fn1'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn2</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">222</span>)</span><br><span class="line">  fn3()</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'fn2'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn3</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">333</span>)</span><br><span class="line">  fn4()</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'fn3'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn4</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">444</span>)</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'fn4'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fn1()</span><br></pre></td></tr></table></figure>
<h4 id="7-6-2-举个例子：计算阶乘的递归函数"><a href="#7-6-2-举个例子：计算阶乘的递归函数" class="headerlink" title="7.6.2 举个例子：计算阶乘的递归函数"></a>7.6.2 举个例子：计算阶乘的递归函数</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span> (<span class="params">num</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (num &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> num * factorial(num - <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="7-6-3-举个例子：求n个数字的和"><a href="#7-6-3-举个例子：求n个数字的和" class="headerlink" title="7.6.3 举个例子：求n个数字的和"></a>7.6.3 举个例子：求n个数字的和</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//递归实现:求n个数字的和   n=5---&gt;  5+4+3+2+1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//函数的声明</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSum</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> x+getSum(x<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//函数的调用</span></span><br><span class="line"><span class="built_in">console</span>.log(getSum(<span class="number">5</span>));</span><br></pre></td></tr></table></figure>
<h4 id="7-6-4-求斐波那契数"><a href="#7-6-4-求斐波那契数" class="headerlink" title="7.6.4 求斐波那契数"></a>7.6.4 求斐波那契数</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFib</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1</span>||x==<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> getFib(x<span class="number">-1</span>)+getFib(x<span class="number">-2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(getFib(<span class="number">12</span>));</span><br></pre></td></tr></table></figure>
<h4 id="7-6-5-递归应用场景"><a href="#7-6-5-递归应用场景" class="headerlink" title="7.6.5 递归应用场景"></a>7.6.5 递归应用场景</h4><ul>
<li><p>遍历 DOM 树</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//从根节点开始遍历</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fromRoot</span>(<span class="params">ele</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//找到根节点的所有孩子</span></span><br><span class="line">    <span class="keyword">var</span> children = ele.children;</span><br><span class="line">    <span class="comment">//遍历根节点的每个孩子</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;children.length;i++)&#123;</span><br><span class="line">        <span class="comment">//获取每一个孩子</span></span><br><span class="line">        <span class="keyword">var</span> c = children[i];</span><br><span class="line">        <span class="comment">//打印节点名称</span></span><br><span class="line">        <span class="built_in">console</span>.log(c.nodeName);</span><br><span class="line">        <span class="comment">//如果每一个孩子下面还有子节点，则继续将每一个孩子看成根节点继续遍历孩子下面的子孩子</span></span><br><span class="line">        c.children &amp;&amp; fromRoot(c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">fromRoot(my$(<span class="string">"box"</span>));</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="7-7-高阶函数"><a href="#7-7-高阶函数" class="headerlink" title="7.7  高阶函数"></a>7.7  高阶函数</h3><ul>
<li>函数可以作为参数</li>
<li>函数可以作为返回值</li>
</ul>
<h4 id="7-7-1-函数作为参数"><a href="#7-7-1-函数作为参数" class="headerlink" title="7.7.1 函数作为参数"></a>7.7.1 函数作为参数</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"f1的函数"</span>);</span><br><span class="line">    <span class="comment">//fn是参数,最后作为函数使用了,函数是可以作为参数使用</span></span><br><span class="line">    fn();<span class="comment">//此时fn当成是一个函数来使用的</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1.传入匿名函数</span></span><br><span class="line">f1(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"我是匿名函数"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.命名函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"f2的函数"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//函数作为参数的时候,如果是命名函数,那么只传入命名函数的名字,没有括号</span></span><br><span class="line">f1(f2);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">eat</span> (<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'吃完了'</span>)</span><br><span class="line">    callback();<span class="comment">//回调</span></span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">eat(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'去唱歌'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">   setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">"定时器开始"</span>);</span><br><span class="line">       fn(); <span class="comment">//回调</span></span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">"定时器结束"</span>);</span><br><span class="line">   &#125;,<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f1(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"好困啊,好累啊,就是想睡觉"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="7-7-2-函数作为返回值"><a href="#7-7-2-函数作为返回值" class="headerlink" title="7.7.2 函数作为返回值"></a>7.7.2 函数作为返回值</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"f1函数开始"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"我是函数,但是此时是作为返回值使用的"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ff=f1();</span><br><span class="line">ff();</span><br></pre></td></tr></table></figure>
<h4 id="7-7-3-判断和获取变量类型的方式"><a href="#7-7-3-判断和获取变量类型的方式" class="headerlink" title="7.7.3 判断和获取变量类型的方式"></a>7.7.3 判断和获取变量类型的方式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.获取变量类型</span></span><br><span class="line"><span class="keyword">var</span> num=<span class="number">10</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> num);<span class="comment">//获取num这个变量的数据类型</span></span><br><span class="line"><span class="keyword">var</span> obj=&#123;&#125;;<span class="comment">//对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.判断这个对象是不是某个类型的</span></span><br><span class="line"><span class="built_in">console</span>.log(obj <span class="keyword">instanceof</span> <span class="built_in">Object</span>);</span><br><span class="line"><span class="built_in">console</span>.log(obj.constructor == <span class="built_in">Object</span>);<span class="comment">//这种方式在函数的原型被改掉后会不适用</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.获取变量类型的第三种方案</span></span><br><span class="line"><span class="comment">//此时输出的是Object的数据类型   [object Object]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString());</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取某个对象的数据类型的样子</span></span><br><span class="line"><span class="comment">//Object.prototype.toString.call(对象);//此时得到的就是这个对象的类型，注意点是这个方法无法获取自定义函数的类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//输出的数组的数据类型      [object Array]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call([]));</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr=[<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>];</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(arr));</span><br></pre></td></tr></table></figure>
<p>​    案例：判断某个对象是否是指定类型的对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断某个对象是否是指定类型的对象</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">genFun</span> (<span class="params">type</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//Object.prototype.toString.call(obj) 输出obj对象的数据类型</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(obj) === type</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> isArray = genFun(<span class="string">'[object Array]'</span>)</span><br><span class="line"><span class="keyword">var</span> isObject = genFun(<span class="string">'[object Object]'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(isArray([])) <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="built_in">console</span>.log(isObject(&#123;&#125;)) <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure>
<h4 id="7-7-4-函数作为参数练习"><a href="#7-7-4-函数作为参数练习" class="headerlink" title="7.7.4 函数作为参数练习"></a>7.7.4 函数作为参数练习</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">100</span>, <span class="number">20</span>, <span class="number">200</span>, <span class="number">40</span>, <span class="number">50</span>, <span class="number">120</span>, <span class="number">10</span>];</span><br><span class="line"><span class="comment">//排序---函数作为参数使用,匿名函数作为sort方法的参数使用,那么此时的匿名函数中有两个参数,</span></span><br><span class="line">arr.sort(<span class="function"><span class="keyword">function</span> (<span class="params">obj1,obj2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(obj1&gt;obj2)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(obj1==obj2)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//字符串可以直接用大于号小于号比较</span></span><br><span class="line"><span class="keyword">var</span> arr1=[<span class="string">"acdef"</span>,<span class="string">"abcd"</span>,<span class="string">"bcedf"</span>,<span class="string">"bced"</span>];</span><br><span class="line">arr1.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a&gt;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(a==b)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr1);</span><br></pre></td></tr></table></figure>
<h4 id="7-7-5-函数作为返回值练习"><a href="#7-7-5-函数作为返回值练习" class="headerlink" title="7.7.5 函数作为返回值练习"></a>7.7.5 函数作为返回值练习</h4><p>案例：排序,每个文件都有名字，大小,时间,都可以按照某个属性的值进行排序</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//三部电影,电影有名字,大小,上映时间</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">File</span>(<span class="params">name, size, time</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;<span class="comment">//电影名字</span></span><br><span class="line">    <span class="keyword">this</span>.size = size;<span class="comment">//电影大小</span></span><br><span class="line">    <span class="keyword">this</span>.time = time;<span class="comment">//电影的上映时间</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> f1 = <span class="keyword">new</span> File(<span class="string">"jack.avi"</span>, <span class="string">"400M"</span>, <span class="string">"1997-12-12"</span>);</span><br><span class="line"><span class="keyword">var</span> f2 = <span class="keyword">new</span> File(<span class="string">"tom.avi"</span>, <span class="string">"200M"</span>, <span class="string">"2017-12-12"</span>);</span><br><span class="line"><span class="keyword">var</span> f3 = <span class="keyword">new</span> File(<span class="string">"xiaosu.avi"</span>, <span class="string">"800M"</span>, <span class="string">"2010-12-12"</span>);</span><br><span class="line"><span class="keyword">var</span> arr = [f1, f2, f3];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">attr</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//函数作为返回值</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">getSort</span>(<span class="params">obj1, obj2</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (obj1[attr] &gt; obj2[attr]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (obj1[attr] == obj2[attr]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ff = fn(<span class="string">"name"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//函数作为参数</span></span><br><span class="line">arr.sort(ff);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(arr[i].name + <span class="string">"====&gt;"</span> + arr[i].size + <span class="string">"===&gt;"</span> + arr[i].time);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-8-函数闭包"><a href="#7-8-函数闭包" class="headerlink" title="7.8 函数闭包"></a>7.8 函数闭包</h3><h4 id="7-8-1-变量作用域的回顾"><a href="#7-8-1-变量作用域的回顾" class="headerlink" title="7.8.1 变量作用域的回顾"></a>7.8.1 变量作用域的回顾</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>变量:局部变量\全局变量\隐式全局变量</span><br><span class="line"><span class="number">2.</span>作用域:就是变量的使用范围</span><br><span class="line">    局部作用域和全局作用域</span><br><span class="line">    js中没有块级作用域 : 括号中定义的变量,这个变量可以在大括号外面使用</span><br><span class="line">    函数中定义的变量是局部变量</span><br><span class="line"><span class="number">3.</span>作用域链:变量的使用,从里向外,层层的搜索,搜索到了就可以直接使用了</span><br><span class="line">    层层搜索,搜索到<span class="number">0</span>级作用域的时候,如果还是没有找到这个变量,结果就是报错</span><br><span class="line"><span class="number">4.</span>预解析:就是在浏览器解析代码之前,把变量的声明和函数的声明提前(提升)到该作用域的最上面。函数的提升先于变量的提升。</span><br></pre></td></tr></table></figure>
<h4 id="7-8-2-什么是闭包"><a href="#7-8-2-什么是闭包" class="headerlink" title="7.8.2 什么是闭包"></a>7.8.2 什么是闭包</h4><p>​    闭包：定义在一个函数内部的函数，静态保存所有了父级作用域的内部函数。</p>
<p>​    闭包的三大特点为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1、函数嵌套函数</span><br><span class="line">2、内部函数可以访问外部函数的变量(函数A中,有一个函数B,函数B中可以访问函数A中定义的变量或者是数据)</span><br><span class="line">3、缓存数据,延长变量的作用域链</span><br></pre></td></tr></table></figure>
<p>​    闭包的分类：函数式闭包和对象模式闭包</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//闭包的主要作用：缓存数据,延长变量的作用域链</span></span><br><span class="line"><span class="comment">//1.函数模式的闭包</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> num = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> ff = f1();</span><br><span class="line">ff();</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.对象模式的闭包</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f3</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> num = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        age:num</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = f3();</span><br><span class="line"><span class="built_in">console</span>.log(obj.age);</span><br></pre></td></tr></table></figure>
<p>​         闭包案例：产生三个随机数，但是这三个数都是相同的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//闭包的主要作用：缓存数据,延长变量的作用域链</span></span><br><span class="line"><span class="comment">//普通函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showRandom</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> num=<span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random()*<span class="number">10</span>+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(num);</span><br><span class="line">&#125;</span><br><span class="line">showRandom();</span><br><span class="line">showRandom();</span><br><span class="line">showRandom();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//闭包产生三个随机数，但是这三个数都是相同的</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> num = <span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random()*<span class="number">10</span>+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> ff = f1();</span><br><span class="line">ff();</span><br><span class="line">ff();</span><br><span class="line">ff();</span><br></pre></td></tr></table></figure>
<p>​    闭包案例：实现函数内变量多次调用的累加</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//闭包的主要作用：缓存数据,延长变量的作用域链</span></span><br><span class="line"><span class="comment">//1.普通的函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> num = <span class="number">10</span>;</span><br><span class="line">    num++;</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(f1());</span><br><span class="line"><span class="built_in">console</span>.log(f1());</span><br><span class="line"><span class="built_in">console</span>.log(f1());</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.函数模式的闭包</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> num = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        num++;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> ff = f2();</span><br><span class="line"><span class="built_in">console</span>.log(ff());<span class="comment">//11</span></span><br><span class="line"><span class="built_in">console</span>.log(ff());<span class="comment">//12</span></span><br><span class="line"><span class="built_in">console</span>.log(ff());<span class="comment">//13</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//可以发现每次ff执行的时候，num的值发生了累加(其实是对应的内存未被释放)</span></span><br></pre></td></tr></table></figure>
<p>​    闭包案例：点赞</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li&gt;<span class="xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images/ly.jpg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"赞(1)"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">	&lt;li&gt;&lt;img src="images/lyml.jpg" alt=""&gt;&lt;br/&gt;&lt;input type="button" value="赞(1)"&gt;&lt;/li&gt;</span><br><span class="line">	&lt;li&gt;&lt;img src="images/fj.jpg" alt=""&gt;&lt;br/&gt;&lt;input type="button" value="赞(1)"&gt;&lt;/li&gt;</span><br><span class="line">	&lt;li&gt;&lt;img src="images/bd.jpg" alt=""&gt;&lt;br/&gt;&lt;input type="button" value="赞(1)"&gt;&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">    ul &#123;</span><br><span class="line">        list-style-type: none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    li &#123;</span><br><span class="line">        float: left;</span><br><span class="line">        margin-left: 10px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    img &#123;</span><br><span class="line">        width: 200px;</span><br><span class="line">        height: 180px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    input &#123;</span><br><span class="line">        margin-left: 30%;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">//1.找到所有的按钮</span><br><span class="line">var buttons = my$byTagName("input");</span><br><span class="line">//2.给每一个按钮绑定点击事件</span><br><span class="line">for(var i=0;i&lt;buttons.length;i++)&#123;</span><br><span class="line">    //给每一个button绑定一个aa属性</span><br><span class="line">    buttons[i].aa = getValue();</span><br><span class="line">    buttons[i].onclick = function()&#123;</span><br><span class="line">        this.value = this.aa();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//3.先给一个函数，函数功能就是生成value属性值</span><br><span class="line">function getValue()&#123;</span><br><span class="line">    var num = 1;</span><br><span class="line">    return function()&#123;</span><br><span class="line">        num ++;</span><br><span class="line">        return "赞("+num+")";</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="7-8-3-闭包的内存分析"><a href="#7-8-3-闭包的内存分析" class="headerlink" title="7.8.3 闭包的内存分析"></a>7.8.3 闭包的内存分析</h4><p><img src="media\bibao1.png" alt></p>
<blockquote>
<p>第一步，代码执行前生成全局上下文环境，并在执行时对其中的变量进行赋值。此时全局上下文环境是活动状态。</p>
</blockquote>
<p><img src="media\bibao2.png" alt></p>
<blockquote>
<p>第二步，执行第17行代码时，调用fn()，产生fn()执行上下文环境，压栈，并设置为活动状态。</p>
</blockquote>
<p><img src="media\bibao3.png" alt></p>
<blockquote>
<p>第三步，执行完第17行，fn()调用完成。按理说应该销毁掉fn()的执行上下文环境，但是这里不能这么做。注意，重点来了：因为执行fn()时，返回的是一个函数。函数的特别之处在于可以创建一个独立的作用域。而正巧合的是，返回的这个函数体中，还有一个自由变量max要引用fn作用域下的fn()上下文环境中的max。因此，这个max不能被销毁，销毁了之后bar函数中的max就找不到值了。</p>
</blockquote>
<blockquote>
<p>因此，这里的fn()上下文环境不能被销毁，还依然存在与执行上下文栈中。</p>
</blockquote>
<blockquote>
<p>即，执行到第18行时，全局上下文环境将变为活动状态，但是fn()上下文环境依然会在执行上下文栈中。另外，执行完第18行，全局上下文环境中的max被赋值为100。如下图：</p>
</blockquote>
<p><img src="media\bibao4.png" alt></p>
<blockquote>
<p>第四步，执行到第20行，执行f1(15)，即执行bar(15)，创建bar(15)上下文环境，并将其设置为活动状态。</p>
</blockquote>
<p><img src="media\bibao5.png" alt></p>
<blockquote>
<p>第五步，执行完20行就是上下文环境的销毁过程，这里就不再赘述了。</p>
</blockquote>
<h4 id="7-8-4-闭包内存案例"><a href="#7-8-4-闭包内存案例" class="headerlink" title="7.8.4 闭包内存案例"></a>7.8.4 闭包内存案例</h4><p>示例1：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">makeAdder</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> num = <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> num++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> x = makeAdder(); <span class="comment">//makeAdder创建作用域对象，makeAdder返回的函数引用该作用域对象(作用域对象不被销毁)</span></span><br><span class="line">    <span class="built_in">console</span>.log(x()); <span class="comment">//5</span></span><br><span class="line">    <span class="built_in">console</span>.log(x()); <span class="comment">//6</span></span><br><span class="line">    x = <span class="literal">null</span>;    <span class="comment">//返回函数的引用计数为0，释放makeAdder作用域对象</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> y = makeAdder();<span class="comment">//makeAdder重新创建作用域对象，makeAdder返回的函数引用该作用域对象(作用域对象不被销毁)</span></span><br><span class="line">    <span class="built_in">console</span>.log(y()); <span class="comment">//5</span></span><br><span class="line">    <span class="built_in">console</span>.log(y());  <span class="comment">//6</span></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/当JavaScript执行一个函数时，都会创建一个作用域对象(scope object)，用来保存在这个函数中创建的局部变量。他和被传入函数的变量一起被初始化。</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/注意点是：</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/第一，每次函数被执行的时候，就会创建一个新的，特定的作用域对象；</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/第二，与全局对象（在浏览器里面是当做window对象来访问的）不同的是，你不能从JavaScript代码中直接访问作用域对象，也没有可以遍历当前作用与对象里面属性的方法。</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/所以当调用 makeAdder 时，解释器创建了一个作用域对象，它带有一个属性：num。然后 makeAdder 返回一个新创建的函数。</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/通常 JavaScript 的垃圾回收器会在这时回收 makeAdder 创建的作用域对象，但是返回的函数却保留一个指向那个作用域对象的引用。结果是这个作用域对象不会被垃圾回收器回收，直到指向 makeAdder 返回的那个函数对象的引用计数为零。</span></span><br></pre></td></tr></table></figure>
<h4 id="7-8-5-定时器和闭包"><a href="#7-8-5-定时器和闭包" class="headerlink" title="7.8.5 定时器和闭包"></a>7.8.5 定时器和闭包</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.无闭包</span></span><br><span class="line"><span class="keyword">var</span> x = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        x[i] = i</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(i);</span><br><span class="line"><span class="built_in">console</span>.log(x); </span><br><span class="line"></span><br><span class="line"><span class="comment">//2.闭包</span></span><br><span class="line"><span class="keyword">var</span> y = [];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSetTimeout</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        y[i] = i;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">    doSetTimeout(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(i);</span><br><span class="line"><span class="built_in">console</span>.log(y); </span><br><span class="line"></span><br><span class="line"><span class="comment">//3.闭包和自调用函数结合</span></span><br><span class="line"><span class="keyword">var</span> z = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">i</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            z[i] = i;</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;)(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(z);</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.闭包和自调用函数结合</span></span><br><span class="line"><span class="keyword">var</span> z = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            z[i] = i;</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;)();</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(z); </span><br><span class="line"></span><br><span class="line"><span class="comment">//5.闭包和自调用函数结合</span></span><br><span class="line"><span class="keyword">var</span> z = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> j = i</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            z[j] = j;</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;)();</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(z);</span><br></pre></td></tr></table></figure>
<h4 id="7-8-6-闭包中的this"><a href="#7-8-6-闭包中的this" class="headerlink" title="7.8.6 闭包中的this"></a>7.8.6 闭包中的this</h4><p>思考题 1：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">"The Window"</span>;</span><br><span class="line"><span class="keyword">var</span> object = &#123;</span><br><span class="line">  name: <span class="string">"My Object"</span>,</span><br><span class="line">  getNameFunc: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(object.getNameFunc()())</span><br></pre></td></tr></table></figure>
<p>思考题 2：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">"The Window"</span>;　　</span><br><span class="line"><span class="keyword">var</span> object = &#123;　　　　</span><br><span class="line">  name: <span class="string">"My Object"</span>,</span><br><span class="line">  getNameFunc: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> that.name;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(object.getNameFunc()())</span><br></pre></td></tr></table></figure>
<h2 id="8-JS的内存管理"><a href="#8-JS的内存管理" class="headerlink" title="8. JS的内存管理"></a>8. JS的内存管理</h2><h3 id="8-1-内存管理介绍"><a href="#8-1-内存管理介绍" class="headerlink" title="8.1 内存管理介绍"></a>8.1 内存管理介绍</h3><p>​    JavaScript具有自动垃圾收集机制，执行环境会负责管理代码执行过程中使用的内存。</p>
<p>　　垃圾收集机制原理：垃圾收集器会按照固定的时间间隔（或代码执行中预定的收集时间）， 周期性地执行这一操作：找出那些不再继续使用的变量，然后释放其占用的内存。</p>
<p>​    JS中大部分浏览器采用标记清除的垃圾回收机制，部分低版本的IE采用引用计数来实现垃圾的回收。</p>
<h3 id="8-2-JS垃圾回收机制-引用计数"><a href="#8-2-JS垃圾回收机制-引用计数" class="headerlink" title="8.2 JS垃圾回收机制-引用计数"></a>8.2 JS垃圾回收机制-引用计数</h3><h4 id="8-2-1-引用计数介绍"><a href="#8-2-1-引用计数介绍" class="headerlink" title="8.2.1 引用计数介绍"></a>8.2.1 引用计数介绍</h4><p>​    这种方式常常会引起内存泄漏，<strong>低版本的IE使用这种方式</strong>。</p>
<p>​    原理：当JavaScript代码生成一个新的内存驻留项时（比如一个对象或函数），系统就会为这个项留出一块内存空间。因为这个对象可能会被传递给很多函数，并且会被指定给很多变量，所以很多代码都会指向这个对象的内存空间。JavaScript会跟踪这些指针，当最后一个指针废弃不用时，这个对象占用的内存会被释放。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A ---------&gt; B ---------&gt; C</span><br><span class="line"></span><br><span class="line"><span class="comment">//例如对象A有一个属性指向B，而B也有一个属性指向C。即使当前作用域中只有对象A有效，但由于指针的关系所有3个对象都必须保留在内存中。当离开A的当前作用域时（例如代码执行到声明A的函数的末尾处），垃圾收集器就可以释放A占用的内存。此时，由于没有什么指向B，因此B可以释放，最后，C也可以释放。</span></span><br></pre></td></tr></table></figure>
<h4 id="8-2-2-引用计数的问题-内存泄漏"><a href="#8-2-2-引用计数的问题-内存泄漏" class="headerlink" title="8.2.2 引用计数的问题-内存泄漏"></a>8.2.2 引用计数的问题-内存泄漏</h4><p>​    内存泄漏是指程序中己动态分配的堆<em>内存</em>由于某种原因程序未释放或无法释放，造成系统<em>内存</em>的浪费，导致程序运行速度减慢甚至系统崩溃等严重后果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//循环引用导致内存泄漏 </span></span><br><span class="line">A ---------&gt; B ------------&gt; C</span><br><span class="line">             ^、_ _ _ _ _ _ _|</span><br><span class="line">                  </span><br><span class="line"><span class="comment">//这里，我们又为对象C添加了一个引用B的属性。在这种情况下，当A释放时，仍然有来自C的指针指向B。这种引用循环需要由JavaScript进行特殊的处理，但必须考虑到整个循环与作用域中的其他变量已经处于隔离状态。</span></span><br></pre></td></tr></table></figure>
<h4 id="8-2-3-什么时候会产生循环引用"><a href="#8-2-3-什么时候会产生循环引用" class="headerlink" title="8.2.3 什么时候会产生循环引用"></a>8.2.3 什么时候会产生循环引用</h4><h5 id="a-闭包的循环引用"><a href="#a-闭包的循环引用" class="headerlink" title="a) 闭包的循环引用"></a>a) 闭包的循环引用</h5><blockquote>
<p>​    闭包可能会导致在不经意间创建循环引用。因为函数是必须保存在内存中的对象，所以位于函数执行上下文中的所有变量也需要保存在内存中：    </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//闭包引起的循环引用</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outerFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> outerVar = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">innerFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(outerVar);</span><br><span class="line">    &#125;</span><br><span class="line">    outerVar.fn = innerFn;</span><br><span class="line">    <span class="keyword">return</span> innerFn;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//	这里创建了一个名为 outerVar 的对象，该对象在内部函数innerFn()中被引用。然后，为 outerVar 创建了一个指向 innerFn()的属性，之后返回了innerFn()。这样就在 innerFn() 上创建了一个引用outerVar的闭包，而outerVar又引用了innerFn()。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这会导致变量在内存中存在的时间比想象得长，而且又不容易被发现。这还不算完，还有可能会出现比这种情况更隐蔽的引用循环：</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outerFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> outerVar = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">innerFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'hello'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    outerVar.fn = innerFn;</span><br><span class="line">    <span class="keyword">return</span> innerFn;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//这里我们修改了innerFn()，不再招惹 outerVar。但是，这样做仍然没有断开循环引用。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//即使innerFn()不再勾引 outerVar，outerVar 也仍然位于innerFn()的封闭环境中。由于闭包的原因，位于 outerFn()中的所有变量都隐含地被 innerFn()所引用。我们再想一想，在 java 中的内部类不也是类似当前情况吗，内部类能够‘看’外部的 this。此时此刻，正如彼时彼刻，竟如此相像。因此，闭包会使意外地创建这些引用循环变得易如反掌。</span></span><br></pre></td></tr></table></figure>
<h5 id="b-DOM与JavaScript的循环引用"><a href="#b-DOM与JavaScript的循环引用" class="headerlink" title="b) DOM与JavaScript的循环引用"></a>b) DOM与JavaScript的循环引用</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//导致这种循环的一个常见原因是简单的事件处理:</span></span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> button = <span class="built_in">document</span>.getElementById(<span class="string">'button-1'</span>);</span><br><span class="line">    button.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'hello'</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//当指定单击事件处理程序时，就创建了一个在其封闭的环境中包含button变量的闭包。而且，现在的button也包含一个指向闭包（onclick属性自身）的引用。这样，就导致了在IE中即使离开当前页面也不会释放这个循环。</span></span><br><span class="line"><span class="comment">//为了释放内存，就需要断开循环引用，例如关闭窗口,删除onclick属性。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//也可以像下面这样重写代码来避免这种闭包：</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'hello'</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> button = <span class="built_in">document</span>.getElementById(<span class="string">'button-1'</span>);</span><br><span class="line">    button.onclick = hello;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//因为hello()函数不再包含 button，引用就成了单向的（从button到hello）,不存的循环，所以就不会造成内存泄漏</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用jQuery化解引用循环</span></span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $button = $(<span class="string">'#button-1'</span>);</span><br><span class="line">    $button.click(<span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">        event.preventDefault();</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'hello'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//即使此时仍然会创建一个闭包，并且也会导致同前面一样的循环，但这里的代码却不会使 IE 发生内存泄漏。由于jQuery考虑到了内存泄漏的潜在危害，所以它会手动释放自己指定的所有事件处理程序。只要坚持使用jQuery的事件绑定方法，就无需为这种特定的常见原因导致的内存泄漏而担心。</span></span><br></pre></td></tr></table></figure>
<p><a href>注意点：低版本的IE中需要注意循环引用的问题</a></p>
<h3 id="8-3-JS垃圾回收机制-标记清除"><a href="#8-3-JS垃圾回收机制-标记清除" class="headerlink" title="8.3 JS垃圾回收机制-标记清除"></a>8.3 JS垃圾回收机制-标记清除</h3><h4 id="8-3-1-标记清除介绍"><a href="#8-3-1-标记清除介绍" class="headerlink" title="8.3.1 标记清除介绍"></a>8.3.1 标记清除介绍</h4><p>​    大部分浏览器以此方式进行垃圾回收，当变量进入执行环境（函数中声明变量）的时候，垃圾回收器将其标记为“进入环境”，当变量离开环境的时候（函数执行结束）将其标记为“离开环境”，在离开环境之后还有的变量则是需要被删除的变量。标记方式不定，可以是某个特殊位的反转或维护一个列表等。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//标记清除算法由以下步骤组成：</span></span><br><span class="line"><span class="number">1.</span>垃圾回收器构建<span class="string">"roots"</span>列表。Roots通常是代码中保留引用的全局变量。在JavaScript中，<span class="string">"window"</span>对象可以作为 root 全局变量示例。</span><br><span class="line"><span class="number">2.</span>所有的<span class="string">"roots"</span>被检查并标记为active（即不是垃圾）。所有的children也被递归检查。从<span class="string">"root"</span>能够到达的一切都不被认为是垃圾。</span><br><span class="line"><span class="number">3.</span>所有为不被标记为active的内存可以被认为是垃圾了。收集器限制可以释放这些内存并将其返回到操作系统。</span><br></pre></td></tr></table></figure>
<p><img src="media\biaojiqingchu.gif" alt></p>
<h4 id="8-3-2-循环引用不再是问题"><a href="#8-3-2-循环引用不再是问题" class="headerlink" title="8.3.2 循环引用不再是问题"></a>8.3.2 循环引用不再是问题</h4><p><img src="media\biaojiqingchu2.png" alt></p>
<p>​    尽管两个对象还是存在引用，但是他们从 root 出发已经是不可达的了。</p>
<h2 id="9-深浅拷贝"><a href="#9-深浅拷贝" class="headerlink" title="9. 深浅拷贝"></a>9. 深浅拷贝</h2><h4 id="9-1-浅拷贝"><a href="#9-1-浅拷贝" class="headerlink" title="9.1 浅拷贝"></a>9.1 浅拷贝</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//浅拷贝：就是把一个对象的地址给了另一个对象,他们指向相同,两个对象之间有共同的属性或者方法,都可以使用</span></span><br><span class="line"><span class="keyword">var</span> obj1=&#123;</span><br><span class="line">    age:<span class="number">10</span>,</span><br><span class="line">    sex:<span class="string">"男"</span>,</span><br><span class="line">    car:[<span class="string">"奔驰"</span>,<span class="string">"宝马"</span>,<span class="string">"特斯拉"</span>,<span class="string">"奥拓"</span>]</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//另一个对象</span></span><br><span class="line"><span class="keyword">var</span> obj2=&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//写一个函数,作用:把一个对象的属性复制到另一个对象中,浅拷贝</span></span><br><span class="line"><span class="comment">//把a对象中的所有的属性复制到对象b中</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">extend</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> a)&#123;</span><br><span class="line">        b[key]=a[key];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">extend(obj1,obj2);</span><br><span class="line"><span class="built_in">console</span>.dir(obj2);<span class="comment">//开始的时候这个对象是空对象</span></span><br><span class="line"><span class="built_in">console</span>.dir(obj1);<span class="comment">//有属性</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//注意点：这边当拷贝car的时候其实是将obj1里面的car数组的引用地址给了obj2里面的car。也就是obj1里面的car和obj2里面的car其实是同一个东西</span></span><br></pre></td></tr></table></figure>
<h4 id="9-2-深拷贝1"><a href="#9-2-深拷贝1" class="headerlink" title="9.2 深拷贝1"></a>9.2 深拷贝1</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//深拷贝:拷贝还是复制,深:把一个对象中所有的属性或者方法,一个一个的找到.并且在另一个对象中开辟相应的空间,一个一个的存储到另一个对象中</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj1=&#123;</span><br><span class="line">    age:<span class="number">10</span>,</span><br><span class="line">    sex:<span class="string">"男"</span>,</span><br><span class="line">    car:[[<span class="string">"鸟不鸟"</span>,<span class="string">"玩不玩"</span>],<span class="string">"宝马"</span>,<span class="string">"特斯拉"</span>,<span class="string">"奥拓"</span>],</span><br><span class="line">    dog:&#123;</span><br><span class="line">        name:<span class="string">"大黄"</span>,</span><br><span class="line">        age:<span class="number">5</span>,</span><br><span class="line">        color:<span class="string">"黑白色"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj2=&#123;&#125;;<span class="comment">//空对象</span></span><br><span class="line"><span class="comment">//通过函数实现,把对象a中的所有的数据深拷贝到对象b中</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">extend</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> a)&#123;</span><br><span class="line">        <span class="comment">//先获取a对象中每个属性的值</span></span><br><span class="line">        <span class="keyword">var</span> item=a[key];</span><br><span class="line">        <span class="comment">//判断这个属性的值是不是数组</span></span><br><span class="line">        <span class="keyword">if</span>(item <span class="keyword">instanceof</span> <span class="built_in">Array</span>)&#123;</span><br><span class="line">            <span class="comment">//如果是数组,那么在b对象中添加一个新的属性,并且这个属性值也是数组</span></span><br><span class="line">            b[key]=[];</span><br><span class="line">            <span class="comment">//调用这个方法，把a对象中这个数组的属性值一个一个的复制到b对象的这个数组属性中</span></span><br><span class="line">            extend(item,b[key]);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(item <span class="keyword">instanceof</span> <span class="built_in">Object</span>)&#123;<span class="comment">//判断这个值是不是对象类型的</span></span><br><span class="line">            <span class="comment">//如果是对象类型的,那么在b对象中添加一个属性,是一个空对象</span></span><br><span class="line">            b[key]=&#123;&#125;;</span><br><span class="line">            <span class="comment">//再次调用这个函数,把a对象中的属性对象的值一个一个的复制到b对象的这个属性对象中</span></span><br><span class="line">            extend(item,b[key]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//如果值是普通的数据,直接复制到b对象的这个属性中</span></span><br><span class="line">            b[key]=item;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extend(obj1,obj2);</span><br><span class="line"><span class="built_in">console</span>.dir(obj1);</span><br><span class="line"><span class="built_in">console</span>.dir(obj2)</span><br></pre></td></tr></table></figure>
<h4 id="9-3-深拷贝2"><a href="#9-3-深拷贝2" class="headerlink" title="9.3 深拷贝2"></a>9.3 深拷贝2</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取对象类型</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getType</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//tostring会返回对应不同的标签的构造函数</span></span><br><span class="line">    <span class="keyword">var</span> toString = <span class="built_in">Object</span>.prototype.toString;</span><br><span class="line">    <span class="keyword">var</span> map = &#123;</span><br><span class="line">        <span class="string">'[object Boolean]'</span>  : <span class="string">'boolean'</span>,</span><br><span class="line">        <span class="string">'[object Number]'</span>   : <span class="string">'number'</span>,</span><br><span class="line">        <span class="string">'[object String]'</span>   : <span class="string">'string'</span>,</span><br><span class="line">        <span class="string">'[object Function]'</span> : <span class="string">'function'</span>,</span><br><span class="line">        <span class="string">'[object Array]'</span>    : <span class="string">'array'</span>,</span><br><span class="line">        <span class="string">'[object Date]'</span>     : <span class="string">'date'</span>,</span><br><span class="line">        <span class="string">'[object RegExp]'</span>   : <span class="string">'regExp'</span>,</span><br><span class="line">        <span class="string">'[object Undefined]'</span>: <span class="string">'undefined'</span>,</span><br><span class="line">        <span class="string">'[object Null]'</span>     : <span class="string">'null'</span>,</span><br><span class="line">        <span class="string">'[object Object]'</span>   : <span class="string">'object'</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">if</span>(obj <span class="keyword">instanceof</span> Element) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'element'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> map[toString.call(obj)];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//深拷贝的方法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepClone</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> type = getType(data);</span><br><span class="line">    <span class="keyword">var</span> obj;</span><br><span class="line">    <span class="keyword">if</span>(type === <span class="string">'array'</span>)&#123;</span><br><span class="line">        obj = [];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(type === <span class="string">'object'</span>)&#123;</span><br><span class="line">        obj = &#123;&#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//不再具有下一层次</span></span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(type === <span class="string">'array'</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, len = data.length; i &lt; len; i++)&#123;</span><br><span class="line">            obj.push(deepClone(data[i]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(type === <span class="string">'object'</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> data)&#123;</span><br><span class="line">            obj[key] = deepClone(data[key]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//对象1</span></span><br><span class="line"><span class="keyword">var</span> obj1=&#123;</span><br><span class="line">    age:<span class="number">10</span>,</span><br><span class="line">    sex:<span class="string">"男"</span>,</span><br><span class="line">    car:[<span class="string">"奔驰"</span>,<span class="string">"宝马"</span>,<span class="string">"特斯拉"</span>,<span class="string">"奥拓"</span>],</span><br><span class="line">    dog:&#123;</span><br><span class="line">        name:<span class="string">"大黄"</span>,</span><br><span class="line">        age:<span class="number">5</span>,</span><br><span class="line">        color:<span class="string">"黑白色"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//对象2 ： 实现深拷贝</span></span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> obj1)&#123;</span><br><span class="line">    obj2[key] = deepClone(obj1[key])</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(obj2);</span><br></pre></td></tr></table></figure>
<h2 id="10-正则表达式简介"><a href="#10-正则表达式简介" class="headerlink" title="10. 正则表达式简介"></a>10. 正则表达式简介</h2><h3 id="10-1-什么是正则表达式"><a href="#10-1-什么是正则表达式" class="headerlink" title="10.1 什么是正则表达式"></a>10.1 什么是正则表达式</h3><p>​    正则表达式：用于匹配规律规则的表达式，正则表达式最初是科学家对人类神经系统的工作原理的早期研究，现在在编程语言中有广泛的应用。正则表通常被用来检索、替换那些符合某个模式(规则)的文本。<br>    正则表达式是对字符串操作的一种逻辑公式，就是用事先定义好的一些特定字符、及这些特定字符的组合，组成一个“规则字符串”，这个“规则字符串”用来表达对字符串的一种过滤逻辑。</p>
<h3 id="10-2-正则表达式的作用"><a href="#10-2-正则表达式的作用" class="headerlink" title="10.2 正则表达式的作用"></a>10.2 正则表达式的作用</h3><ol>
<li>给定的字符串是否符合正则表达式的过滤逻辑(匹配)</li>
<li>可以通过正则表达式，从字符串中获取我们想要的特定部分(提取)</li>
<li>强大的字符串替换能力(替换)</li>
</ol>
<h3 id="10-3-正则表达式的特点"><a href="#10-3-正则表达式的特点" class="headerlink" title="10.3 正则表达式的特点"></a>10.3 正则表达式的特点</h3><ol>
<li>灵活性、逻辑性和功能性非常的强</li>
<li>可以迅速地用极简单的方式达到字符串的复杂控制</li>
<li>对于刚接触的人来说，比较晦涩难懂</li>
</ol>
<h3 id="10-4-正则表达式的测试"><a href="#10-4-正则表达式的测试" class="headerlink" title="10.4 正则表达式的测试"></a>10.4 正则表达式的测试</h3><ul>
<li><a href="https://c.runoob.com/front-end/854" target="_blank" rel="noopener">在线测试正则</a></li>
<li><p>工具中使用正则表达式</p>
<ul>
<li><p>sublime/vscode/word</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sublime调试正则</span></span><br><span class="line"><span class="number">1</span>、按command+F(windows:ctrl+f)调出查找面板</span><br><span class="line"><span class="number">2</span>、点击上图中最左侧的『.*』开启正则模式；</span><br><span class="line"><span class="number">3</span>、在查找输入框输入正则匹配的模式（.*）部分即是正则表达式部分</span><br></pre></td></tr></table></figure>
</li>
<li><p>演示替换所有的数字</p>
</li>
</ul>
</li>
</ul>
<h3 id="10-5-正则表达式的组成"><a href="#10-5-正则表达式的组成" class="headerlink" title="10.5 正则表达式的组成"></a>10.5 正则表达式的组成</h3><ul>
<li>普通字符</li>
<li>特殊字符(元字符)：正则表达式中有特殊意义的字符</li>
</ul>
<p>示例演示：</p>
<ul>
<li><code>\d</code> 匹配数字</li>
<li><code>ab\d</code> 匹配 ab1、ab2</li>
</ul>
<h3 id="10-6-元字符串"><a href="#10-6-元字符串" class="headerlink" title="10.6 元字符串"></a>10.6 元字符串</h3><p>通过测试工具演示下面元字符的使用</p>
<h4 id="10-6-1-常用元字符串"><a href="#10-6-1-常用元字符串" class="headerlink" title="10.6.1 常用元字符串"></a>10.6.1 常用元字符串</h4><p>元字符：除了\n之外的其他任意字符</p>
<table>
<thead>
<tr>
<th>元字符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>\d</td>
<td>匹配数字</td>
</tr>
<tr>
<td>\D</td>
<td>匹配任意非数字的字符</td>
</tr>
<tr>
<td>\w</td>
<td>匹配字母或数字或下划线</td>
</tr>
<tr>
<td>\W</td>
<td>匹配任意不是字母，数字，下划线</td>
</tr>
<tr>
<td>\s</td>
<td>匹配任意的空白符</td>
</tr>
<tr>
<td>\S</td>
<td>匹配任意不是空白符的字符</td>
</tr>
<tr>
<td>.</td>
<td>匹配除换行符以外的任意单个字符</td>
</tr>
<tr>
<td>^</td>
<td>表示匹配行首的文本(以谁开始)</td>
</tr>
<tr>
<td>$</td>
<td>表示匹配行尾的文本(以谁结束)</td>
</tr>
<tr>
<td>\b</td>
<td>表示单词边界匹配符   what are you</td>
</tr>
</tbody>
</table>
<h4 id="10-6-2-限定符"><a href="#10-6-2-限定符" class="headerlink" title="10.6.2 限定符"></a>10.6.2 限定符</h4><table>
<thead>
<tr>
<th>限定符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>*</td>
<td>重复零次或更多次</td>
</tr>
<tr>
<td>+</td>
<td>重复一次或更多次</td>
</tr>
<tr>
<td>?</td>
<td>重复零次或一次</td>
</tr>
<tr>
<td>{n}</td>
<td>重复n次</td>
</tr>
<tr>
<td>{n,}</td>
<td>重复n次或更多次</td>
</tr>
<tr>
<td>{n,m}</td>
<td>重复n到m次</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//限定符:限定前面的表达式出现的次数</span></span><br><span class="line">*    表示的是:前面的表达式出现了<span class="number">0</span>次到多次</span><br><span class="line">[a-z][<span class="number">0</span><span class="number">-9</span>]*  小写字母中的任意一个,后面是要么是没有数字的,要么是多个数字的</span><br><span class="line"></span><br><span class="line">+    表示的是:前面的表达式出现了<span class="number">1</span>次到多次</span><br><span class="line">[a-z][<span class="number">9</span>]+    小写字母一个后面最少一个<span class="number">9</span>,或者多个<span class="number">9</span></span><br><span class="line"></span><br><span class="line">?    表示的是:前面的表达式出现了<span class="number">0</span>次到<span class="number">1</span>次,最少是<span class="number">0</span>次,最多<span class="number">1</span>次 。另一个含义:阻止贪婪模式</span><br><span class="line">[<span class="number">4</span>][a-z]?    <span class="number">4</span>后面可以出现a~z，也可以没有</span><br><span class="line"></span><br><span class="line">n&#123;<span class="number">0</span>,&#125; 表示的是n出现了<span class="number">0</span>次到多次,和*一样的</span><br><span class="line">n&#123;<span class="number">1</span>,&#125; 表示的是n出现了<span class="number">1</span>次到多次,和 +一样的</span><br><span class="line">n&#123;<span class="number">0</span>,<span class="number">1</span>&#125; 表示的是n出现了<span class="number">0</span>次到<span class="number">1</span>次,和 ?一样的</span><br><span class="line">n&#123;<span class="number">5</span>,<span class="number">10</span>&#125; 表示的是前面的n出现了<span class="number">5</span>次到<span class="number">10</span>次</span><br><span class="line">n&#123;<span class="number">4</span>&#125;  表示n出现了<span class="number">4</span>次</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span><span class="number">-7</span>] 表示的是<span class="number">1</span>到<span class="number">7</span>之间的任意的一个数字</span><br><span class="line">[a-z] 表示的是:所有的小写的字母中的任意的一个</span><br><span class="line">[A-Z] 表示的是:所有的大写的字母中的任意的一个</span><br><span class="line">[a-zA-Z] 表示的是:所有的字母的任意的一个</span><br><span class="line">[<span class="number">0</span><span class="number">-9</span>a-zA-Z] 表示的是: 所有的数字或者是字母中的一个</span><br><span class="line">[\u4e00-\u9fa5]  匹配汉字</span><br><span class="line"></span><br><span class="line">^ 表示的是以什么开始,或者是取非(取反) </span><br><span class="line">^[<span class="number">0</span><span class="number">-9</span>] 以数字开头</span><br><span class="line">^[a-z] 以小写字母开始</span><br><span class="line">[^<span class="number">0</span><span class="number">-9</span>] 取反,非数字</span><br><span class="line">[^a-z] 非小写字母</span><br><span class="line">[^<span class="number">0</span><span class="number">-9</span>a-zA-Z_] 不再<span class="number">0</span>到<span class="number">9</span> a到z A到Z之间</span><br><span class="line"></span><br><span class="line">$ 表示的是以什么结束   [<span class="number">0</span><span class="number">-9</span>][a-z]$  必须以小写字母结束</span><br></pre></td></tr></table></figure>
<h4 id="10-6-3-其它"><a href="#10-6-3-其它" class="headerlink" title="10.6.3 其它"></a>10.6.3 其它</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\  转义符</span><br><span class="line">|  或者。选择两者中的一个。注意|将左右两边分为两部分，而不管左右两边有多长多乱。</span><br><span class="line">        [0-9]|[a-z] 表示的是要么是一个数字,要么是一个小写的字母</span><br><span class="line">() 分组。[0-9]|([a-z])|[A-Z]         gr(a|e)y匹配gray和grey</span><br><span class="line">        ([0-9])([1-5])([a-z]) 三组, 从最左边开始计算</span><br></pre></td></tr></table></figure>
<h2 id="11-JavaScript-中使用正则表达式"><a href="#11-JavaScript-中使用正则表达式" class="headerlink" title="11. JavaScript 中使用正则表达式"></a>11. JavaScript 中使用正则表达式</h2><h3 id="11-1-创建正则对象"><a href="#11-1-创建正则对象" class="headerlink" title="11.1 创建正则对象"></a>11.1 创建正则对象</h3><p>方式1：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'\d'</span>, <span class="string">'i'</span>);</span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'\d'</span>, <span class="string">'gi'</span>);</span><br></pre></td></tr></table></figure>
<p>方式2：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/\d/i</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/\d/gi</span>;</span><br></pre></td></tr></table></figure>
<p>参数</p>
<table>
<thead>
<tr>
<th>标志</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>i</td>
<td>忽略大小写</td>
</tr>
<tr>
<td>g</td>
<td>全局匹配</td>
</tr>
<tr>
<td>gi</td>
<td>全局匹配+忽略大小写</td>
</tr>
</tbody>
</table>
<h3 id="11-2-正则对象的常用方法"><a href="#11-2-正则对象的常用方法" class="headerlink" title="11.2 正则对象的常用方法"></a>11.2 正则对象的常用方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reg.test(<span class="string">"字符串"</span>)  <span class="comment">//查看字符串是否符合指定的正则表达式，返回true和false</span></span><br><span class="line">reg.exec(<span class="string">"字符串"</span>)  <span class="comment">//用正则表达式模式在字符串中运行查找，并返回包含该查找结果的一个数组</span></span><br></pre></td></tr></table></figure>
<h3 id="11-3-匹配正则表达式"><a href="#11-3-匹配正则表达式" class="headerlink" title="11.3 匹配正则表达式"></a>11.3 匹配正则表达式</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在字符串中查找是否有符合条件的</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/[a-zA-Z]+/</span>.test(<span class="string">"hello"</span>));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/./</span>.test(<span class="string">"除了回车换行以为的任意字符"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/.*/</span>.test(<span class="string">"0个到多个"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/.+/</span>.test(<span class="string">"1个到多个"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/.?/</span>.test(<span class="string">"哈哈"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/[a-z]/</span>.test(<span class="string">"what"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/[A-Z]/</span>.test(<span class="string">"Are"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/[a-zA-Z]/</span>.test(<span class="string">"干啥子"</span>));<span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/[0-9a-zA-Z]/</span>.test(<span class="string">"9ebg"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/b|(ara)/</span>.test(<span class="string">"abra"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/[a-z]&#123;2,3&#125;/</span>.test(<span class="string">"arfsf"</span>));<span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\d/</span>.test(<span class="string">"998"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\d*/</span>.test(<span class="string">"998"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\d+/</span>.test(<span class="string">"998"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\d&#123;0,&#125;/</span>.test(<span class="string">"998"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\d&#123;2,3&#125;/</span>.test(<span class="string">"998"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\D/</span>.test(<span class="string">"eat"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\s/</span>.test(<span class="string">"  "</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\S/</span>.test(<span class="string">"嘎嘎"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\w/</span>.test(<span class="string">"_"</span>));<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/\W/</span>.test(<span class="string">"_"</span>));<span class="comment">//fasle</span></span><br></pre></td></tr></table></figure>
<h3 id="11-4-正则匹配案例"><a href="#11-4-正则匹配案例" class="headerlink" title="11.4 正则匹配案例"></a>11.4 正则匹配案例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.查看字符串是否包含数字</span></span><br><span class="line"><span class="comment">//var reg = new RegExp("\\d+");</span></span><br><span class="line"><span class="keyword">var</span> reg =<span class="regexp">/\d+/</span>;  <span class="comment">//相比上面写法少了转义字符</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// test 方法检查在字符串中是否存在一个模式，如果存在则返回 true，否则就返回 false。</span></span><br><span class="line">alert(reg.test(<span class="string">"abc123"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.需求：校验QQ号码</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/^[1-9]\d&#123;4,10&#125;$/</span>;</span><br><span class="line">alert(reg.test(<span class="string">"11533"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.固定电话的正则</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/^(0\d&#123;2,3&#125;-)?[1-9]\d&#123;7&#125;$/</span>;</span><br><span class="line">alert(reg.test(<span class="string">"021-88882222"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.匹配日期</span></span><br><span class="line"><span class="keyword">var</span> dateStr = <span class="string">'2015-10-10'</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;$/</span></span><br><span class="line"><span class="built_in">console</span>.log(reg.test(dateStr));</span><br><span class="line"></span><br><span class="line"><span class="comment">//5.查看字符串是否以数字开头以数字结束</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/^(\d+)$|^(\d+)(.)*(\d+)$/</span>;</span><br><span class="line">alert(reg.test(<span class="string">"abc123"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//注意点：其中^表示开头，$表示结束，/^\d+$/表示需要匹配的字符串必须以数字开头，必须以数字结束。如果去掉，则会进行部分匹配</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//6.验证中文名字(2到6位)</span></span><br><span class="line"><span class="keyword">var</span> reg=<span class="regexp">/^[\u4e00-\u9fa5]&#123;2,6&#125;$/</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//7.需求：找出所有3个英文字母组成的单词</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"da Jia hao hao xue xi zheng qu sheng lii"</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/\b[a-z]&#123;3&#125;\b/ig</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// exec 方法:用正则表达式模式在字符串中运行查找，并返回包含该查找结果的一个数组。</span></span><br><span class="line"><span class="keyword">while</span>((line = reg.exec(str)) !=<span class="literal">null</span>)&#123;</span><br><span class="line">  	alert(line);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//8.把里面所有的数字全部显示出来</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">"中国移动:10086,中国联通:10010,中国电信:10000"</span>; </span><br><span class="line"><span class="keyword">var</span> reg=<span class="regexp">/\d&#123;5&#125;/g</span>;</span><br><span class="line"><span class="comment">//通过正则表达式匹配这个字符串</span></span><br><span class="line"><span class="keyword">var</span> line=reg.exec(str);</span><br><span class="line"><span class="keyword">while</span> (line!=<span class="literal">null</span>)&#123;</span><br><span class="line">   <span class="comment">//输出匹配的内容</span></span><br><span class="line">   <span class="built_in">console</span>.log(line[<span class="number">0</span>]);</span><br><span class="line">   line=reg.exec(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="11-5-分组提取"><a href="#11-5-分组提取" class="headerlink" title="11.5 分组提取"></a>11.5 分组提取</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 1. 提取日期中的年部分  2015-5-10</span></span><br><span class="line"><span class="keyword">var</span> dateStr = <span class="string">'2016-1-5'</span>;</span><br><span class="line"><span class="comment">// 正则表达式中的()作为分组来使用，获取分组匹配到的结果用Regex.$1 $2 $3....来获取</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/(\d&#123;4&#125;)-\d&#123;1,2&#125;-\d&#123;1,2&#125;/</span>;</span><br><span class="line"><span class="keyword">if</span> (reg.test(dateStr)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">RegExp</span>.$<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 提取邮件中的每一部分</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/(\w+)@(\w+)\.(\w+)(\.\w+)?/</span>;</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"123123@xx.com"</span>;</span><br><span class="line"><span class="keyword">if</span> (reg.test(str)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">RegExp</span>.$<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">RegExp</span>.$<span class="number">2</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">RegExp</span>.$<span class="number">3</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="12-字符串中正则的使用"><a href="#12-字符串中正则的使用" class="headerlink" title="12. 字符串中正则的使用"></a>12. 字符串中正则的使用</h2><h3 id="12-1-字符串中支持正则方法"><a href="#12-1-字符串中支持正则方法" class="headerlink" title="12.1 字符串中支持正则方法"></a>12.1 字符串中支持正则方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">match()    <span class="comment">//match方法返回符合条件的集合</span></span><br><span class="line">replace()  <span class="comment">//替换字符串</span></span><br><span class="line">search()   <span class="comment">//查找字符串</span></span><br><span class="line">split()    <span class="comment">//切割字符串</span></span><br></pre></td></tr></table></figure>
<h3 id="12-2-字符串正则提取"><a href="#12-2-字符串正则提取" class="headerlink" title="12.2 字符串正则提取"></a>12.2 字符串正则提取</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//match方法返回符合条件的集合</span></span><br><span class="line"><span class="comment">//1.查找字符串中所有连续出现的数字，放入数组</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">"abc123ee23f90"</span>;</span><br><span class="line">alert(str.match(<span class="regexp">/\d+/g</span>));</span><br><span class="line">alert(str.match(<span class="regexp">/\d+/</span>));<span class="comment">//如果这里没有/g，只会找到第一个符合条件的放入数组</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.查找字符串中所有的数字，放入数组</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">"abc123ee23f90"</span>;</span><br><span class="line">alert(str.match(<span class="regexp">/\d/g</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 提取工资</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"张三：1000，李四：5000，王五：8000。"</span>;</span><br><span class="line"><span class="keyword">var</span> array = str.match(<span class="regexp">/\d+/g</span>); </span><br><span class="line"><span class="built_in">console</span>.log(array);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 提取email地址</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"123123@xx.com,fangfang@valuedopinions.cn 286669312@qq.com 2、emailenglish@emailenglish.englishtown.com 286669312@qq.com..."</span>;</span><br><span class="line"><span class="keyword">var</span> array = str.match(<span class="regexp">/\w+@\w+\.\w+(\.\w+)?/g</span>);  <span class="comment">//(\.\w+)?  表示可能出现0次或者多次</span></span><br><span class="line"><span class="built_in">console</span>.log(array);</span><br><span class="line"></span><br><span class="line"><span class="comment">//5.把里面所有的数字全部显示出来</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">"中国移动:10086,中国联通:10010,中国电信:10000"</span>; </span><br><span class="line"><span class="keyword">var</span> array=str.match(<span class="regexp">/\d&#123;5&#125;/g</span>);</span><br><span class="line"><span class="built_in">console</span>.log(array);</span><br></pre></td></tr></table></figure>
<h3 id="12-3-贪婪模式和懒惰模式"><a href="#12-3-贪婪模式和懒惰模式" class="headerlink" title="12.3 贪婪模式和懒惰模式"></a>12.3 贪婪模式和懒惰模式</h3><p>​    所谓贪婪匹配就是匹配重复字符是尽可能多的匹配</p>
<p>​    懒惰模式就是匹配的时候尽可能的少匹配</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"aaaaa"</span>.match(<span class="regexp">/a+/</span>);    <span class="comment">//贪婪模式：["aaaaa"]</span></span><br><span class="line"><span class="string">"aaaaa"</span>.match(<span class="regexp">/a+?/</span>);   <span class="comment">//懒惰模式(使用?号)：["a"]</span></span><br><span class="line"></span><br><span class="line"><span class="string">'0a123ba123b'</span>.match(<span class="regexp">/a[a-b0-9]*b/</span>);	  <span class="comment">//贪婪模式: ["a123ba123b"]</span></span><br><span class="line"><span class="string">'0a123ba123b'</span>.match(<span class="regexp">/a[a-b0-9]*?b/</span>);  <span class="comment">//懒惰模式 ：["a123b"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//按照贪婪和懒惰模式，下面的结有问题：</span></span><br><span class="line"><span class="string">"aaab"</span>.match(<span class="regexp">/a+b/</span>);   <span class="comment">//["aaab"]</span></span><br><span class="line"><span class="string">"aaab"</span>.match(<span class="regexp">/a+?b/</span>);  <span class="comment">//["aaab"]  这边明明是懒惰模式，可是匹配结果仍然是"aaab"</span></span><br><span class="line"><span class="comment">//原因是正则表达式的模式匹配总是会寻找字符串中第一个可能匹配的位置。</span></span><br></pre></td></tr></table></figure>
<h3 id="12-4-字符串正则替换"><a href="#12-4-字符串正则替换" class="headerlink" title="12.4 字符串正则替换"></a>12.4 字符串正则替换</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 替换所有空白</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"   123AD  asadf   asadfasf  adf "</span>;</span><br><span class="line">str = str.replace(<span class="regexp">/\s/g</span>,<span class="string">"xx"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 替换所有,|，</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"abc,efg,123，abc,123，a"</span>;</span><br><span class="line">str = str.replace(<span class="regexp">/,|，/g</span>, <span class="string">"."</span>);</span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.替换字符串中所有的 – 和 + 号</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"a-b-+b-c"</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/-|\+/g</span>;  <span class="comment">//注意，此处没有加边界匹配器，因为要替换所有的-,g表示匹配的模式,+号需要转义</span></span><br><span class="line">alert(str.replace(reg, <span class="string">"*"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.替换字符串中的所有的帅</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">"你好帅哦,真的是太帅了,帅,就是真帅"</span>;</span><br><span class="line">str=str.replace(<span class="regexp">/帅/g</span>,<span class="string">"猥琐"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br><span class="line"></span><br><span class="line"><span class="comment">//5.替换字符串中的所有的h</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">"HhpphH"</span>;<span class="comment">//SSppSS</span></span><br><span class="line">str=str.replace(<span class="regexp">/[h]/gi</span>,<span class="string">"S"</span>);  <span class="comment">//i忽略大小写</span></span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br><span class="line"></span><br><span class="line"><span class="comment">//6.替换重叠词</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"妮妮好好啊，我好喜喜欢你"</span>;</span><br><span class="line"><span class="keyword">var</span> str1 = str.replace(<span class="regexp">/(.)\1+/g</span>,<span class="string">"$1"</span>)</span><br><span class="line">alert(str1);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//7.替换标签为空字符串</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"&lt;p&gt; 你好小明 &lt;/p&gt; &lt;div&gt;王鹏&lt;/div&gt;"</span>;</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/&lt;[^&lt;&gt;]+&gt;/g</span>;  <span class="comment">//标签中除了&lt;&gt;不能放，其他都能放，所以是[^&lt;&gt;]</span></span><br><span class="line">alert(str.replace(reg, <span class="string">""</span>));</span><br></pre></td></tr></table></figure>
<p><img src="media\bb.png" alt></p>
<h3 id="12-5-字符串正则其他方法"><a href="#12-5-字符串正则其他方法" class="headerlink" title="12.5 字符串正则其他方法"></a>12.5 字符串正则其他方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.查找字符串中指定字符</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"a-b-b-c"</span>;</span><br><span class="line"><span class="comment">//忽略大小写查找</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/a/i</span>;  </span><br><span class="line"><span class="comment">//打印结果是所查找的内容在字符串中出现的第一个位置</span></span><br><span class="line">alert(str.search(reg));</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.切割字符串</span></span><br><span class="line"><span class="keyword">var</span> str=<span class="string">"a|b|c|"</span>;</span><br><span class="line"><span class="keyword">var</span> arr=str.split(<span class="regexp">/\W+/</span>);</span><br><span class="line">alert(arr)</span><br></pre></td></tr></table></figure>
<h3 id="12-6-正则案例：验证密码强度"><a href="#12-6-正则案例：验证密码强度" class="headerlink" title="12.6 正则案例：验证密码强度"></a>12.6 正则案例：验证密码强度</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"dv"</span>&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"pwd"</span>&gt;密码&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">	&lt;input type="text" id="pwd" maxlength="16"&gt;&lt;!--课外话题--&gt;</span></span><br><span class="line"><span class="regexp">	&lt;div&gt;</span></span><br><span class="line"><span class="regexp">    	&lt;em&gt;密码强度：&lt;/</span>em&gt;</span><br><span class="line">		&lt;em id=<span class="string">"strength"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">em</span>&gt;</span></span></span><br><span class="line">		&lt;div id=<span class="string">"strengthLevel"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"strengthLv0"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">	&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line">&lt;script src=<span class="string">"common.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;style type=<span class="string">"text/css"</span>&gt;</span><br><span class="line">    #dv&#123;</span><br><span class="line">        width: <span class="number">300</span>px;</span><br><span class="line">        height:<span class="number">200</span>px;</span><br><span class="line">        position: absolute;</span><br><span class="line">        left:<span class="number">300</span>px;</span><br><span class="line">        top:<span class="number">100</span>px;</span><br><span class="line">    &#125;</span><br><span class="line">    .strengthLv0 &#123;</span><br><span class="line">        height: <span class="number">6</span>px;</span><br><span class="line">        width: <span class="number">120</span>px;</span><br><span class="line">        border: 1px solid #ccc;</span><br><span class="line">        padding: <span class="number">2</span>px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .strengthLv1 &#123;</span><br><span class="line">        background: red;</span><br><span class="line">        height: <span class="number">6</span>px;</span><br><span class="line">        width: <span class="number">40</span>px;</span><br><span class="line">        border: 1px solid #ccc;</span><br><span class="line">        padding: <span class="number">2</span>px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .strengthLv2 &#123;</span><br><span class="line">        background: orange;</span><br><span class="line">        height: <span class="number">6</span>px;</span><br><span class="line">        width: <span class="number">80</span>px;</span><br><span class="line">        border: 1px solid #ccc;</span><br><span class="line">        padding: <span class="number">2</span>px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .strengthLv3 &#123;</span><br><span class="line">        background: green;</span><br><span class="line">        height: <span class="number">6</span>px;</span><br><span class="line">        width: <span class="number">120</span>px;</span><br><span class="line">        border: 1px solid #ccc;</span><br><span class="line">        padding: <span class="number">2</span>px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	.strengthLv4 &#123;</span><br><span class="line">        background: black;</span><br><span class="line">        height: <span class="number">6</span>px;</span><br><span class="line">        width: <span class="number">150</span>px;</span><br><span class="line">        border: 1px solid #ccc;</span><br><span class="line">        padding: <span class="number">2</span>px;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">my$("pwd").onkeyup = function()&#123;</span></span><br><span class="line"><span class="regexp">    var value = this.value;</span></span><br><span class="line"><span class="regexp">    var level = 0;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/1.如果输入的内容中函数字  强度是0</span></span><br><span class="line"><span class="regexp">    if(/</span>\d+<span class="regexp">/.test(value))&#123;</span></span><br><span class="line"><span class="regexp">        level++;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/2.如果输入的内容含小写字母  强度是1</span></span><br><span class="line"><span class="regexp">    if(/</span>[a-z]+<span class="regexp">/.test(value))&#123;</span></span><br><span class="line"><span class="regexp">        level++;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/3.如果输入的内容含大写字母  强度是2</span></span><br><span class="line"><span class="regexp">    if(/</span>[A-Z]+<span class="regexp">/.test(value))&#123;</span></span><br><span class="line"><span class="regexp">        level++;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/4.如果输入的内容含非字符  强度是3</span></span><br><span class="line"><span class="regexp">    if(/</span>\W+<span class="regexp">/.test(value))&#123;</span></span><br><span class="line"><span class="regexp">        level++;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    my$("strengthLevel").className = "strengthLv"+level;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="12-7-正则案例：表单验证"><a href="#12-7-正则案例：表单验证" class="headerlink" title="12.7 正则案例：表单验证"></a>12.7 正则案例：表单验证</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">QQ号：&lt;input type=<span class="string">"text"</span> id=<span class="string">"txtQQ"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line">邮箱：&lt;input type="text" id="txtEMail"&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;</span><br><span class="line">手机：&lt;input type="text" id="txtPhone"&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;</span><br><span class="line">生日：&lt;input type="text" id="txtBirthday"&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;</span><br><span class="line">姓名：&lt;input type="text" id="txtName"&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">//1.获取页面所有的inputs</span><br><span class="line">var inputs = my$byTagName("input");</span><br><span class="line">//2.遍历inputs绑定事件</span><br><span class="line">for(var i=0;i&lt;inputs.length;i++)&#123;</span><br><span class="line">    inputs[i].onblur = function()&#123;</span><br><span class="line">        checkCorrect(this);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//3.每次文本框失去焦点时候确定文本框对应的正则以及提示</span><br><span class="line">function checkCorrect(ele)&#123;</span><br><span class="line">    var reg = null;</span><br><span class="line">    var tip = null;</span><br><span class="line">    //检验QQ</span><br><span class="line">    if(ele.getAttribute("name") == "qq") &#123;</span><br><span class="line">        reg = /^[1-9]\d&#123;4,10&#125;$/;</span><br><span class="line">        tip = "请输入正确的QQ号码";</span><br><span class="line">    &#125;</span><br><span class="line">    //校验email</span><br><span class="line">    else if(ele.getAttribute("name") == "email")&#123;</span><br><span class="line">        reg = /^\w+@\w+\.\w+(\.\w+)?$/;</span><br><span class="line">        tip = "请输入正确的email";</span><br><span class="line">    &#125;</span><br><span class="line">    else if(ele.getAttribute("name") == "phone")&#123;</span><br><span class="line">        reg = /^1[34578]\d&#123;9&#125;$/;</span><br><span class="line">        tip = "请输入正确的手机号码";</span><br><span class="line">    &#125;</span><br><span class="line">    else if(ele.getAttribute("name") == "birthday")&#123;</span><br><span class="line">        reg = /^((\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;))$/;</span><br><span class="line">        tip = "请输入正确的生日";</span><br><span class="line">    &#125;</span><br><span class="line">    else if(ele.getAttribute("name") == "name")&#123;</span><br><span class="line">        reg = /^\w&#123;2,&#125;$/;</span><br><span class="line">        tip = "请输入正确的名字";</span><br><span class="line">    &#125;</span><br><span class="line">    //真正去进行校验</span><br><span class="line">    doCheck(ele,reg,tip);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//正则的校验</span><br><span class="line">function doCheck(element, reg, tip)&#123;</span><br><span class="line">    //获取当前input的下一个兄弟元素</span><br><span class="line">    var span = element.nextElementSibling;</span><br><span class="line">    //如果正则校验通过，则输入正确</span><br><span class="line">    if(reg.test(element.value))&#123;</span><br><span class="line">        span.style.color = "green";</span><br><span class="line">        setInnerText(span,"输入正确");</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        span.style.color = "red";</span><br><span class="line">        setInnerText(span,tip);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="13-JSON"><a href="#13-JSON" class="headerlink" title="13. JSON"></a>13. JSON</h2><p>​    JSON（JavaScript Object Notation） 是一种通过普通字符串描述数据的手段，用于表示有结构的数据。JSON是JavaScript的原生对象，类似于JS中字面量的概念，语法上跟 JavaScript 的字面量非常类似。</p>
<h3 id="13-1-JSON对象的数据"><a href="#13-1-JSON对象的数据" class="headerlink" title="13.1. JSON对象的数据"></a>13.1. JSON对象的数据</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">#1.JSON对象的key始终是字符串</span><br><span class="line"></span><br><span class="line">#2.JSON对象的值可以是以下类型</span><br><span class="line">1.null</span><br><span class="line">2.string : "hello json"</span><br><span class="line">3.number : 2048</span><br><span class="line">4.boolean : true</span><br><span class="line">5.object</span><br><span class="line">6.array</span><br><span class="line"></span><br><span class="line">#3.JSON对象和JSON字符串</span><br><span class="line">#3.1 JSON格式的js对象</span><br><span class="line">/*我们可以把这个称做：JSON格式的JavaScript对象 */</span><br><span class="line">var obj5=&#123;"width":100,"height":200,"name":"rose"&#125;; </span><br><span class="line">/*我们可以把这个称做：JSON格式的字符串 */</span><br><span class="line">var str1='&#123;"width":100,"height":200,"name":"rose"&#125;';</span><br><span class="line"></span><br><span class="line">#3.2 JSON格式的数组</span><br><span class="line">/*这个叫JSON格式的数组，是JSON的稍复杂一点的形式 */</span><br><span class="line">var a=[</span><br><span class="line">           &#123;"width":100,"height":200,"name":"rose"&#125;,</span><br><span class="line">           &#123;"width":100,"height":200,"name":"rose"&#125;,</span><br><span class="line">           &#123;"width":100,"height":200,"name":"rose"&#125;,</span><br><span class="line">      ];</span><br><span class="line">/* 这个叫稍复杂一点的JSON格式的字符串 */</span><br><span class="line">var str2='['+</span><br><span class="line">                '&#123;"width":100,"height":200,"name":"rose"&#125;,'+</span><br><span class="line">                '&#123;"width":100,"height":200,"name":"rose"&#125;,'+</span><br><span class="line">                '&#123;"width":100,"height":200,"name":"rose"&#125;,'+</span><br><span class="line">         ']' ;</span><br><span class="line">    </span><br><span class="line">#4.JSON对象的注意点</span><br><span class="line">1. JSON 中属性名称必须用双引号包裹</span><br><span class="line">2. JSON 中字符串必须使用双引号,width\height等必须是双引号</span><br><span class="line">3. JSON 中不能有单行或多行注释</span><br><span class="line">4. JSON 没有 undefined 这个值</span><br><span class="line"></span><br><span class="line">#5.JS中JSON对象和JSON字符串的相互转换</span><br><span class="line">//JS中，对象转字符串    JSON.stringify(对象)</span><br><span class="line">//JS中，字符串转对象    JSON.parse(字符串)</span><br><span class="line"></span><br><span class="line">#6.PHP中JSON字符串和PHP对象的转换</span><br><span class="line">#6.1 php中将PHP变量转换为字符串</span><br><span class="line">json_encode( mixed value[,intoptions = 0 ])  对变量进行JSON编码，第二个参数一般不用</span><br><span class="line">$book = array('a'=&gt;'xiyouji','b'=&gt;'sanguo','c'=&gt;'shuihu','d'=&gt;'hongloumeng');</span><br><span class="line">$json = json_encode($book);</span><br><span class="line">echo $json;</span><br><span class="line"></span><br><span class="line">#6.2 php中将JSON字符串转换为PHP变量</span><br><span class="line">json_decode(string json[,boolassoc ])  :接受一个JSON格式的字符串并且把它转换为PHP变量 </span><br><span class="line">如果希望以关联数组的方式而非对象的方式操作数据，可以将 json_decode 的第二个参数设置为 true</span><br><span class="line">$obj = json_decode($json,true);</span><br><span class="line">var_dump($obj);</span><br></pre></td></tr></table></figure>
<h3 id="13-2-JSON-表述数据"><a href="#13-2-JSON-表述数据" class="headerlink" title="13.2 JSON 表述数据"></a>13.2 JSON 表述数据</h3><p>​    有了 JSON 这种格式，我们就可以更加容易的表示拥有复杂结构的数据了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"id"</span>: <span class="string">"59d632855434e"</span>,</span><br><span class="line">        <span class="string">"title"</span>: <span class="string">"错过"</span>,</span><br><span class="line">        <span class="string">"artist"</span>: <span class="string">"梁咏琪"</span>,</span><br><span class="line">        <span class="string">"images"</span>: [<span class="string">"/uploads/img/1.jpg"</span>],</span><br><span class="line">        <span class="string">"source"</span>: <span class="string">"/uploads/mp3/1.mp3"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"id"</span>: <span class="string">"59d632855434f"</span>,</span><br><span class="line">        <span class="string">"title"</span>: <span class="string">"开始懂了"</span>,</span><br><span class="line">        <span class="string">"artist"</span>: <span class="string">"孙燕姿"</span>,</span><br><span class="line">        <span class="string">"images"</span>: [<span class="string">"/uploads/img/2.jpg"</span>],</span><br><span class="line">        <span class="string">"source"</span>: <span class="string">"/uploads/mp3/2.mp3"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"id"</span>: <span class="string">"59d6328554350"</span>,</span><br><span class="line">        <span class="string">"title"</span>: <span class="string">"一生中最爱"</span>,</span><br><span class="line">        <span class="string">"artist"</span>: <span class="string">"谭咏麟"</span>,</span><br><span class="line">        <span class="string">"images"</span>: [<span class="string">"/uploads/img/3.jpg"</span>],</span><br><span class="line">        <span class="string">"source"</span>: <span class="string">"/uploads/mp3/3.mp3"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"id"</span>: <span class="string">"59d6328554351"</span>,</span><br><span class="line">        <span class="string">"title"</span>: <span class="string">"爱在深秋"</span>,</span><br><span class="line">        <span class="string">"artist"</span>: <span class="string">"谭咏麟"</span>,</span><br><span class="line">        <span class="string">"images"</span>: [<span class="string">"/uploads/img/4.jpg"</span>],</span><br><span class="line">        <span class="string">"source"</span>: <span class="string">"/uploads/mp3/4.mp3"</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[&#123;<span class="string">"title"</span>:<span class="string">"zhangjie"</span>,<span class="string">"artist"</span>:<span class="string">"zhangjie"</span>,<span class="string">"images"</span>:[<span class="string">"uploads\/bb.png"</span>],<span class="string">"source"</span>:<span class="string">"uploads\/\u5f20\u6770 - \u6211\u7684\u672a\u6765\u4e0d\u662f\u68a6 (\u4f34\u594f).mp3"</span>&#125;,&#123;<span class="string">"title"</span>:<span class="string">"22"</span>,<span class="string">"artist"</span>:<span class="string">"222"</span>,<span class="string">"images"</span>:[<span class="string">"uploads\/bb.png"</span>],<span class="string">"source"</span>:<span class="string">"uploads\/\u5f20\u6770 - \u6211\u7684\u672a\u6765\u4e0d\u662f\u68a6 (\u4f34\u594f).mp3"</span>&#125;]</span><br></pre></td></tr></table></figure>
<p>### </p>

    </div>

    

    

    <!-- Comments -->
    

</div>
        </section>

    </div>
</div>


</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    This theme was developed by <a href="https://github.com/klugjo">Jonathan Klughertz</a>. The source code is available on Github. Create Websites. Make Magic.
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2019/05/06/03-JavaScript高级/">Untitled</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2019/05/06/Web API/">Untitled</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2019/05/06/CSS/">Untitled</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2018/01/09/html简介/">html简介</a>
            </li>
            
        </ul>
    </div>



            
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/klugjo/hexo-theme-alpha-dust">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://twitter.com/?lang=en">
                            <span class="footer-icon-container">
                                <i class="fa fa-twitter"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://www.facebook.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-facebook"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://www.instagram.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-instagram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://dribbble.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-dribbble"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://plus.google.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-google-plus"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://www.behance.net/">
                            <span class="footer-icon-container">
                                <i class="fa fa-behance"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://500px.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-500px"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:test@example.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="\#">
                            <span class="footer-icon-container">
                                <i class="fa fa-rss"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @Untitled. All right reserved | Design & Hexo <a href="http://www.codeblocq.com/">Jonathan Klughertz</a>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/js/main.js"></script>

<!-- Disqus Comments -->



</body>

</html>